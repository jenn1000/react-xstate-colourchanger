{"code":"(this[\"webpackJsonpxstate-react-typescript-template\"]=this[\"webpackJsonpxstate-react-typescript-template\"]||[]).push([[0],{22:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.d(__webpack_exports__,\"a\",(function(){return parse}));var _srgs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);function LOG(t){}function clone(t){if(null==t||\"object\"!=typeof t)return t;var e=new t.constructor;for(var n in t)e[n]=clone(t[n]);return e}function isEmpty(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Chart(t){this.numberOfWords=t,this.passives=new Array(t),this.actives=new Array(t);for(var e=0;e<=t;e++)this.passives[e]={},this.actives[e]={};this.add=function(t){var e,n;return t.isPassive?(e=this.passives[t.start],n=t.lhs):(e=this.actives[t.end],n=t.next.content),n in e||(e[n]={}),!(t in e[n])&&(e[n][t]=t,!0)},this.resultsForRule=function(e,n,r){n=n||0,r=r||t;var s=[],i=this.passives[n][e];for(var o in i)i[o].end==r&&s.push(i[o].out);return s},this.allEdges=function(){return this.allPassiveEdges().concat(this.allActiveEdges())},this.allPassiveEdges=function(){var t=[];for(var e in this.passives)for(var n in this.passives[e])for(var r in this.passives[e][n])t.push(this.passives[e][n][r]);return t},this.allActiveEdges=function(){var t=[];for(var e in this.actives)for(var n in this.actives[e])for(var r in this.actives[e][n])t.push(this.actives[e][n][r]);return t},this.statistics=function(){var t=this.allPassiveEdges().length,e=this.allActiveEdges().length;return{nrEdges:t+e,nrPassiveEdges:t,nrActiveEdges:e}}}function PassiveEdge(t,e,n,r){this.start=t,this.end=e,this.lhs=n,this.out=r,this.isPassive=!0;var s=\"[\"+t+\"-\"+e+\"] $\"+n+\" := \"+r;this._string=s,this.toString=function(){return this._string}}function ActiveEdge(t,e,n,r,s,i,o,a){this.start=t,this.end=e,this.lhs=n,this.next=r,this.rest=s,this.out=i,this.rules=o,this.text=a,this.isPassive=!1;var c=\"<\"+t+\"-\"+e+\"> $\"+n+\" -> \"+r+\", \"+s+\" := \"+i+\" <- \"+o;this._string=c,this.toString=function(){return this._string}}function parse(words,grammar,root,filter){root||(root=grammar.$root);var chart=new Chart(words.length),agenda=[],leftCornerFilter;function addToChart(inference,start,end,lhs,rhs,out,rules,text){var edge;if(rhs.length>0){var next=rhs[0],rest=rhs.slice(1);switch(next.constructor){case Array:return void addToChart(inference+\",SEQUENCE\",start,end,lhs,next.concat(rest),out,rules,text);case _srgs__WEBPACK_IMPORTED_MODULE_0__.g:var min=next.min,max=next.max;if(min<=0&&addToChart(inference+\",SKIP\",start,end,lhs,rest,out,rules,text),max>0){var content=next.content,rhs=1==max?[content]:[content,_srgs__WEBPACK_IMPORTED_MODULE_0__.f(min?min-1:min,max-1,content)];addToChart(inference+\",REPEAT\",start,end,lhs,rhs.concat(rest),out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.c:var oneof=next.content;for(var i in oneof){var rhs=oneof[i].concat(rest);addToChart(inference+\",ONEOF\",start,end,lhs,rhs,out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.i:return out=clone(out),rules=clone(rules),eval(next.content),void addToChart(inference+\",TAG\",start,end,lhs,rest,out,rules,text)}edge=new ActiveEdge(start,end,lhs,next,rest,out,rules,text)}else edge=new PassiveEdge(start,end,lhs,out);chart.add(edge)&&(LOG(\"+ \"+inference+\": \"+edge),agenda.push(edge))}for(leftCornerFilter=void 0==filter?function(){return!0}:function(t,e){var n=filter[t];return!n||words[e]in n},addToChart(\"INIT\",0,0,root,grammar[root],{},{},{});agenda.length>0;){var edge=agenda.pop(),start=edge.start,end=edge.end,lhs=edge.lhs,next=edge.next;if(LOG(edge),edge.isPassive){var actives=chart.actives[start][lhs];for(var i in actives){var active=actives[i],rules=clone(active.rules),text=active.text;text[edge.lhs]=words.slice(start,end).join(\" \"),\"object\"==typeof edge.out&&isEmpty(edge.out)?rules[edge.lhs]=text[edge.lhs]:rules[edge.lhs]=clone(edge.out),addToChart(\"COMBINE\",active.start,end,active.lhs,active.rest,active.out,rules,text)}}else if(next.constructor==_srgs__WEBPACK_IMPORTED_MODULE_0__.e){var ref=next.content,passives=chart.passives[end][ref];for(var i in passives){var passive=passives[i],rules=clone(edge.rules),text=edge.text;rules[passive.lhs]=clone(passive.out),text[passive.lhs]=passive.text,addToChart(\"COMBINE\",start,passive.end,lhs,edge.rest,edge.out,rules,text)}ref in grammar&&leftCornerFilter(ref,end)&&addToChart(\"PREDICT\",end,end,ref,grammar[ref],{},{},{})}else next==words[end]&&addToChart(\"SCAN\",start,end+1,lhs,edge.rest,edge.out,edge.rules,edge.text)}return chart}},26:function(t,e,n){},37:function(t,e,n){\"use strict\";n.r(e);var r=n(25),s=n(11),i=(n(26),n(7),n(21)),o=n(43),a=n(4),c=n(42),u=n(41),l=n(8);function h(t){for(var e=t.childNodes,n=[],r=0;r<e.length;r++)if(3==e[r].nodeType){var s=e[r].textContent.trim();\"\"!=s&&n.push(s.split(/ +/))}else if(1==e[r].nodeType)if(\"token\"==e[r].nodeName)n.push(l.h(e[r].textContent));else if(\"ruleref\"==e[r].nodeName){var i=e[r].getAttribute(\"uri\");n.push(l.d(i.slice(1)))}else if(\"tag\"==e[r].nodeName)n.push(l.h(e[r].textContent.trim()));else if(\"one-of\"==e[r].nodeName)n.push(l.b(h(e[r])));else if(\"item\"==e[r].nodeName){var o=e[r].getAttribute(\"repeat\");if(o){var a=o.split(\"-\"),c=parseInt(a[0]),u=parseInt(a[1]);u=u||1/0,n.push(l.f(c,u,h(e[r])))}else n.push(h(e[r]))}else console.log(e[r]);return n}var d=n(22);const g=function(t){for(var e=function(t){if(\"undefined\"!=typeof DOMParser)return(new DOMParser).parseFromString(t,\"application/xml\");if(\"undefined\"!=typeof ActiveXObject){var e=XML.newDocument();return e.loadXML(t),e}var n=\"data:text/xml;charset=utf-8,\"+encodeURIComponent(t),r=new XMLHttpRequest;return r.open(\"GET\",n,!1),r.send(null),r.responseXML}(t),n=e.getElementsByTagName(\"grammar\")[0].getAttribute(\"root\"),r=new l.a(n),s=e.getElementsByTagName(\"rule\"),i=0;i<s.length;i++){var o=s[i];r[o.getAttribute(\"id\")]=h(o)}return r}('\\n<grammar root=\"order\">\\n   <rule id=\"order\">\\n      I would like a\\n      <ruleref uri=\"#drink\"/>\\n      <tag>out.drink = new Object(); out.drink.liquid=rules.drink.type;\\n           out.drink.drinksize=rules.drink.drinksize;</tag>\\n      and\\n      <ruleref uri=\"#pizza\"/>\\n      <tag>out.pizza=rules.pizza;</tag>\\n   </rule>\\n   <rule id=\"kindofdrink\">\\n      <one-of>\\n         <item>coke</item>\\n         <item>pepsi</item>\\n         <item>coca cola<tag>out=\"coke\";</tag></item>\\n      </one-of>\\n   </rule>\\n   <rule id=\"foodsize\">\\n      <tag>out=\"medium\";</tag> \\x3c!-- \"medium\" is default if nothing said --\\x3e\\n      <item repeat=\"0-1\">\\n         <one-of>\\n            <item>small<tag>out=\"small\";</tag></item>\\n            <item>medium</item>\\n            <item>large<tag>out=\"large\";</tag></item>\\n            <item>regular<tag>out=\"medium\";</tag></item>\\n         </one-of>\\n      </item>\\n   </rule>\\n   \\x3c!-- Construct Array of toppings, return Array --\\x3e\\n   <rule id=\"tops\">\\n      <tag>out=new Array;</tag>\\n      <ruleref uri=\"#top\"/>\\n      <tag>out.push(rules.top);</tag>\\n      <item repeat=\"1-\">\\n         and\\n         <ruleref uri=\"#top\"/>\\n         <tag>out.push(rules.top);</tag>\\n      </item>\\n   </rule>\\n   <rule id=\"top\">\\n      <one-of>\\n         <item>anchovies</item>\\n         <item>pepperoni</item>\\n         <item>mushroom<tag>out=\"mushrooms\";</tag></item>\\n         <item>mushrooms</item>\\n      </one-of>\\n   </rule>\\n   \\x3c!-- Two properties (drinksize, type) on left hand side Rule Variable --\\x3e\\n   <rule id=\"drink\">\\n      <ruleref uri=\"#foodsize\"/>\\n      <ruleref uri=\"#kindofdrink\"/>\\n      <tag>out.drinksize=rules.foodsize; out.type=rules.kindofdrink;</tag>\\n   </rule>\\n   \\x3c!-- Three properties on rules.pizza --\\x3e\\n   <rule id=\"pizza\">\\n      <ruleref uri=\"#number\"/>\\n      <ruleref uri=\"#foodsize\"/>\\n      <tag>out.pizzasize=rules.foodsize; out.number=rules.number;</tag>\\n      pizzas with\\n      <ruleref uri=\"#tops\"/>\\n      <tag>out.topping=rules.tops;</tag>\\n   </rule>\\n   <rule id=\"number\">\\n      <one-of>\\n         <item>\\n            <tag>out=1;</tag>\\n            <one-of>\\n               <item>a</item>\\n               <item>one</item>\\n            </one-of>\\n         </item>\\n         <item>two<tag>out=2;</tag></item>\\n         <item>three<tag>out=3;</tag></item>\\n      </one-of>\\n   </rule>\\n</grammar>\\n'),p=Object(d.a)(\"I would like a coca cola and three large pizzas with pepperoni and mushrooms\".split(/\\s+/),g).resultsForRule(g.$root)[0];console.log(p);const f=Object(a.k)((t=>({type:\"SPEAK\",value:\"Repainting to \".concat(t.recResult)})));function m(t){return Object(a.k)((e=>({type:\"SPEAK\",value:t})))}const v={initial:\"init\",states:{init:{on:{CLICK:\"welcome\"}},welcome:Object(s.a)({on:{RECOGNISED:[{target:\"stop\",cond:t=>\"stop\"===t.recResult},{target:\"repaint\"}]}},(x=\"Tell me the colour\",{initial:\"prompt\",states:{prompt:{entry:m(x),on:{ENDSPEECH:\"ask\"}},ask:{entry:Object(a.k)(\"LISTEN\")}}})),stop:{entry:m(\"Ok\"),always:\"init\"},repaint:{initial:\"prompt\",states:{prompt:{entry:f,on:{ENDSPEECH:\"repaint\"}},repaint:{entry:\"changeColour\",always:\"#root.dm.welcome\"}}}}};var x,E=n(20),_=n(13);Object(u.a)({url:\"https://statecharts.io/inspect\",iframe:!1});const b=Object(o.a)({id:\"root\",type:\"parallel\",states:{dm:Object(s.a)({},v),asrtts:{initial:\"idle\",states:{idle:{on:{LISTEN:\"recognising\",SPEAK:{target:\"speaking\",actions:Object(a.b)(((t,e)=>({ttsAgenda:e.value})))}}},recognising:{initial:\"progress\",entry:\"recStart\",exit:\"recStop\",on:{ASRRESULT:{actions:[\"recLogResult\",Object(a.b)(((t,e)=>({recResult:e.value})))],target:\".match\"},RECOGNISED:\"idle\"},states:{progress:{},match:{entry:Object(a.k)(\"RECOGNISED\")}}},speaking:{entry:\"ttsStart\",on:{ENDSPEECH:\"idle\"}}}}}},{actions:{recLogResult:t=>{console.log(\"<< ASR: \"+t.recResult)},test:()=>{console.log(\"test\")},logIntent:t=>{console.log(\"<< NLU intent: \"+t.nluData.intent.name)}}}),O=t=>{switch(!0){case t.state.matches({asrtts:\"recognising\"}):return Object(_.jsx)(\"button\",Object(s.a)(Object(s.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},t),{},{children:\"Listening...\"}));case t.state.matches({asrtts:\"speaking\"}):return Object(_.jsx)(\"button\",Object(s.a)(Object(s.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},t),{},{children:\"Speaking...\"}));default:return Object(_.jsx)(\"button\",Object(s.a)(Object(s.a)({type:\"button\",className:\"glow-on-hover\"},t),{},{children:\"Click to start\"}))}};function y(){const t=Object(E.useSpeechSynthesis)({onEnd:()=>{h(\"ENDSPEECH\")}}),e=t.speak,n=t.cancel,s=(t.speaking,Object(E.useSpeechRecognition)({onResult:t=>{h({type:\"ASRRESULT\",value:t})}})),i=s.listen,o=(s.listening,s.stop),a=Object(c.b)(b,{devTools:!0,actions:{recStart:Object(c.a)((()=>{console.log(\"Ready to receive a color command.\"),i({interimResults:!1,continuous:!0})})),recStop:Object(c.a)((()=>{console.log(\"Recognition stopped.\"),o()})),changeColour:Object(c.a)((t=>{console.log(\"Repainting...\"),document.body.style.background=t.recResult})),ttsStart:Object(c.a)(((t,n)=>{console.log(\"Speaking...\"),e({text:t.ttsAgenda})})),ttsCancel:Object(c.a)(((t,e)=>{console.log(\"TTS STOP...\"),n()}))}}),u=Object(r.a)(a,3),l=u[0],h=u[1];u[2];return Object(_.jsx)(\"div\",{className:\"App\",children:Object(_.jsx)(O,{state:l,onClick:()=>h(\"CLICK\")})})}const k=document.getElementById(\"root\");i.render(Object(_.jsx)(y,{}),k)},8:function(t,e,n){\"use strict\";function r(t){this.$root=t,this.VOID=[o([])],this.NULL=[],this.GARBAGE=[],this.$check=function(){for(var t in this)if(\"$root\"!==t&&\"$check\"!==t)try{g(this[t])}catch(e){d(\"When checking grammar rule '\"+t+\"'\",e)}}}function s(t){return new c(t)}function i(t){return new u(t)}function o(t){return new l(t)}function a(t,e,n){return new h(t,e,n)}function c(t){this.content=t,this._string=\"$\"+t,this.toString=function(){return this._string}}function u(t){this.content=t,this._string=\"{\"+t+\"}\",this.toString=function(){return this._string}}function l(t){this.content=t,this._string=\"(\"+t.join(\"|\")+\")\",this.toString=function(){return this._string}}function h(t,e,n){this.min=t,this.max=e,this.content=n,this._string=this.content+\"<\"+this.min+\"-\"+(this.max==1/0?\"\":this.max)+\">\",this.toString=function(){return this._string}}function d(t,e){throw void 0==e?TypeError(t):TypeError(t+\"; \"+e.message)}function g(t){try{for(var e in t.constructor!==Array&&d(\"Expected Array, found \"+t.constructor.name),t)t[e].constructor==Array?g(t[e]):t[e].constructor!=String&&t[e].checkExpansion()}catch(n){d(\"When checking sequence expansion\",n)}}n.d(e,\"a\",(function(){return r})),n.d(e,\"d\",(function(){return s})),n.d(e,\"h\",(function(){return i})),n.d(e,\"b\",(function(){return o})),n.d(e,\"f\",(function(){return a})),n.d(e,\"e\",(function(){return c})),n.d(e,\"i\",(function(){return u})),n.d(e,\"c\",(function(){return l})),n.d(e,\"g\",(function(){return h})),c.prototype.checkExpansion=function(){this.content.constructor!==String&&d(\"When checking Ref content; Expected String, found \"+this.content.constructor.name)},u.prototype.checkExpansion=function(){this.content.constructor!==String&&d(\"When checking Tag content; Expected String, found \"+this.content.constructor.name)},l.prototype.checkExpansion=function(){try{for(var t in this.content.constructor!==Array&&d(\"Expected Array, found \"+this.content.constructor.name),this.content)g(this.content[t])}catch(e){d(\"When checking OneOf content\",e)}},h.prototype.checkExpansion=function(){try{this.min.constructor===Number&&this.max.constructor===Number||d(\"Expected min/max to be Number, found \"+this.min.constructor.name+\"/\"+this.max.constructor.name),0<=this.min&&this.min<=this.max||d(\"Expected 0 <= min <= max, found \"+this.min+\"/\"+this.max),g(this.content)}catch(t){d(\"When checking Repeat content\",t)}}}},[[37,1,2]]]);","name":"static/js/main.aa245078.chunk.js","map":{"version":3,"sources":["static/js/main.aa245078.chunk.js"],"names":["this","push","22","module","__webpack_exports__","__webpack_require__","d","parse","_srgs__WEBPACK_IMPORTED_MODULE_0__","LOG","str","clone","obj","temp","constructor","key","isEmpty","ob","i","hasOwnProperty","Chart","numberOfWords","passives","Array","actives","add","edge","subchart","cat","isPassive","start","lhs","end","next","content","resultsForRule","results","finalEdges","out","allEdges","allPassiveEdges","concat","allActiveEdges","edges","j","k","statistics","length","nrEdges","nrPassiveEdges","nrActiveEdges","PassiveEdge","_string","toString","ActiveEdge","rest","rules","text","words","grammar","root","filter","$root","chart","agenda","leftCornerFilter","addToChart","inference","rhs","slice","min","max","oneof","eval","undefined","ruleref","position","leftCorners","pop","active","join","ref","passive","26","exports","37","r","slicedToArray","objectSpread2","react_dom","Machine","actions","useMachine","browser","srgs","processRuleExpansions","xrule","xitems","childNodes","rule","nodeType","textContent","trim","split","nodeName","uri","getAttribute","repeat","parseInt","Infinity","console","log","chartparser","gram","dom","DOMParser","parseFromString","ActiveXObject","doc","XML","newDocument","loadXML","url","encodeURIComponent","request","XMLHttpRequest","open","send","responseXML","parseXML","getElementsByTagName","xrules","loadGrammar","result","Object","sayColour","context","type","value","recResult","say","_context","dmMachine","initial","states","init","on","CLICK","welcome","RECOGNISED","target","cond","prompt","entry","ENDSPEECH","ask","stop","always","repaint","dist","jsx_runtime","iframe","machine","id","dm","asrtts","idle","LISTEN","SPEAK","event","ttsAgenda","recognising","exit","ASRRESULT","progress","match","speaking","recLogResult","test","logIntent","nluData","intent","name","ReactiveButton","props","state","matches","className","style","animation","children","App","_useSpeechSynthesis","onEnd","speak","cancel","_useSpeechRecognition","onResult","listen","listening","_useMachine","devTools","recStart","interimResults","continuous","recStop","changeColour","document","body","background","ttsStart","effect","ttsCancel","_useMachine2","current","onClick","rootElement","getElementById","8","Grammar","VOID","OneOf","NULL","GARBAGE","$check","checkSequenceExpansion","err","throwRuleError","Ref","RefClass","Tag","tag","TagClass","alternatives","OneOfClass","Repeat","sequence","RepeatClass","message","error","TypeError","String","checkExpansion","prototype","Number"],"mappings":"CAACA,KAAK,gDAAkDA,KAAK,iDAAmD,IAAIC,KAAK,CAAC,CAAC,GAAG,CAExHC,GACA,SAAUC,OAAQC,oBAAqBC,qBAE7C,aAC+BA,oBAAoBC,EAAEF,oBAAqB,KAAK,WAAa,OAAOG,SAC9E,IAAIC,mCAAqCH,oBAAoB,GAyBlF,SAASI,IAAIC,IAIb,SAASC,MAAMC,GAAK,GAAQ,MAALA,GAAuB,iBAALA,EAAe,OAAOA,EAAK,IAAIC,EAAK,IAAID,EAAIE,YAAc,IAAI,IAAIC,KAAOH,EAAKC,EAAKE,GAAKJ,MAAMC,EAAIG,IAAO,OAAOF,EAAM,SAASG,QAAQC,GAAI,IAAI,IAAIC,KAAKD,EAAI,GAAGA,EAAGE,eAAeD,GAAI,OAAO,EAAQ,OAAO,EAGpP,SAASE,MAAMC,GAAerB,KAAKqB,cAAcA,EAAcrB,KAAKsB,SAAS,IAAIC,MAAMF,GAAerB,KAAKwB,QAAQ,IAAID,MAAMF,GAAe,IAAI,IAAIH,EAAE,EAAEA,GAAGG,EAAcH,IAAKlB,KAAKsB,SAASJ,GAAG,GAAGlB,KAAKwB,QAAQN,GAAG,GAGlNlB,KAAKyB,IAAI,SAAaC,GAAM,IAAIC,EAASC,EAA6K,OAAtKF,EAAKG,WAAWF,EAAS3B,KAAKsB,SAASI,EAAKI,OAAOF,EAAIF,EAAKK,MAAUJ,EAAS3B,KAAKwB,QAAQE,EAAKM,KAAKJ,EAAIF,EAAKO,KAAKC,SAAcN,KAAOD,IAAWA,EAASC,GAAK,MAAOF,KAAQC,EAASC,MAAyBD,EAASC,GAAKF,GAAMA,GAAY,IAGnS1B,KAAKmC,eAAe,SAAwBJ,EAAID,EAAME,GAAKF,EAAMA,GAAO,EAAEE,EAAIA,GAAKX,EAAc,IAAIe,EAAQ,GAAOC,EAAWrC,KAAKsB,SAASQ,GAAOC,GAAK,IAAI,IAAIb,KAAKmB,EAAeA,EAAWnB,GAAGc,KAAKA,GAAKI,EAAQnC,KAAKoC,EAAWnB,GAAGoB,KAAO,OAAOF,GAEtPpC,KAAKuC,SAAS,WAAoB,OAAOvC,KAAKwC,kBAAkBC,OAAOzC,KAAK0C,mBAAoB1C,KAAKwC,gBAAgB,WAA2B,IAAIG,EAAM,GAAG,IAAI,IAAIzB,KAAKlB,KAAKsB,SAAS,IAAI,IAAIsB,KAAK5C,KAAKsB,SAASJ,GAAG,IAAI,IAAI2B,KAAK7C,KAAKsB,SAASJ,GAAG0B,GAAGD,EAAM1C,KAAKD,KAAKsB,SAASJ,GAAG0B,GAAGC,IAAI,OAAOF,GAAQ3C,KAAK0C,eAAe,WAA0B,IAAIC,EAAM,GAAG,IAAI,IAAIzB,KAAKlB,KAAKwB,QAAQ,IAAI,IAAIoB,KAAK5C,KAAKwB,QAAQN,GAAG,IAAI,IAAI2B,KAAK7C,KAAKwB,QAAQN,GAAG0B,GAAGD,EAAM1C,KAAKD,KAAKwB,QAAQN,GAAG0B,GAAGC,IAAI,OAAOF,GAEpe3C,KAAK8C,WAAW,WAAsB,IAAIxB,EAAStB,KAAKwC,kBAAkBO,OAAWvB,EAAQxB,KAAK0C,iBAAiBK,OAAO,MAAM,CAACC,QAAQ1B,EAASE,EAAQyB,eAAe3B,EAAS4B,cAAc1B,IAEhM,SAAS2B,YAAYrB,EAAME,EAAID,EAAIO,GAAKtC,KAAK8B,MAAMA,EAAM9B,KAAKgC,IAAIA,EAAIhC,KAAK+B,IAAIA,EAAI/B,KAAKsC,IAAIA,EAAItC,KAAK6B,WAAU,EAAK,IAAInB,EAAI,IAAIoB,EAAM,IAAIE,EAAI,MAAMD,EAAI,OAAOO,EAAItC,KAAKoD,QAAQ1C,EAAIV,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAAW,SAASE,WAAWxB,EAAME,EAAID,EAAIE,EAAKsB,EAAKjB,EAAIkB,EAAMC,GAAMzD,KAAK8B,MAAMA,EAAM9B,KAAKgC,IAAIA,EAAIhC,KAAK+B,IAAIA,EAAI/B,KAAKiC,KAAKA,EAAKjC,KAAKuD,KAAKA,EAAKvD,KAAKsC,IAAIA,EAAItC,KAAKwD,MAAMA,EAAMxD,KAAKyD,KAAKA,EAAKzD,KAAK6B,WAAU,EAAM,IAAInB,EAAI,IAAIoB,EAAM,IAAIE,EAAI,MAAMD,EAAI,OAAOE,EAAK,KAAKsB,EAAK,OAAOjB,EAAI,OAAOkB,EAAMxD,KAAKoD,QAAQ1C,EAAIV,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAUrkB,SAAS7C,MAAMmD,MAAMC,QAAQC,KAAKC,QAAYD,OAAMA,KAAKD,QAAQG,OAAO,IAAIC,MAAM,IAAI3C,MAAMsC,MAAMX,QAAYiB,OAAO,GAAOC,iBAC5H,SAASC,WAAWC,UAAUrC,MAAME,IAAID,IAAIqC,IAAI9B,IAAIkB,MAAMC,MAAM,IAAI/B,KAAK,GAAG0C,IAAIrB,OAAO,EAAE,CAAC,IAAId,KAAKmC,IAAI,GAAOb,KAAKa,IAAIC,MAAM,GAAG,OAAOpC,KAAKnB,aAAa,KAAKS,MAC7E,YAAjF2C,WAAWC,UAAU,YAAYrC,MAAME,IAAID,IAAIE,KAAKQ,OAAOc,MAAMjB,IAAIkB,MAAMC,MAAa,KAAKjD,mCAAwD,EACrJ,IAAI8D,IAAIrC,KAAKqC,IAAQC,IAAItC,KAAKsC,IAE9B,GADGD,KAAK,GAAGJ,WAAWC,UAAU,QAAQrC,MAAME,IAAID,IAAIwB,KAAKjB,IAAIkB,MAAMC,MAClEc,IAAI,EAAE,CAAC,IAAIrC,QAAQD,KAAKC,QAAYkC,IAAS,GAALG,IAAO,CAACrC,SAAS,CAACA,QAAQ1B,mCAAmD,EAAE8D,IAAIA,IAAI,EAAEA,IAAIC,IAAI,EAAErC,UAAUgC,WAAWC,UAAU,UAAUrC,MAAME,IAAID,IAAIqC,IAAI3B,OAAOc,MAAMjB,IAAIkB,MAAMC,MAAO,OAAO,KAAKjD,mCAAuD,EAC1S,IAAIgE,MAAMvC,KAAKC,QAAQ,IAAI,IAAIhB,KAAKsD,MAAM,CAAC,IAAIJ,IAAII,MAAMtD,GAAGuB,OAAOc,MAAMW,WAAWC,UAAU,SAASrC,MAAME,IAAID,IAAIqC,IAAI9B,IAAIkB,MAAMC,MAAO,OAAO,KAAKjD,mCAAqD,EACvF,OAApH8B,IAAI3B,MAAM2B,KAAKkB,MAAM7C,MAAM6C,OAAOiB,KAAKxC,KAAKC,cAASgC,WAAWC,UAAU,OAAOrC,MAAME,IAAID,IAAIwB,KAAKjB,IAAIkB,MAAMC,MAAc/B,KAAK,IAAI4B,WAAWxB,MAAME,IAAID,IAAIE,KAAKsB,KAAKjB,IAAIkB,MAAMC,WAAY/B,KAAK,IAAIyB,YAAYrB,MAAME,IAAID,IAAIO,KAC9NyB,MAAMtC,IAAIC,QAAOjB,IAAI,KAAK0D,UAAU,KAAKzC,MAAMsC,OAAO/D,KAAKyB,OAE9D,IAVmKuC,sBAAXS,GAARb,OAAoC,WAA4B,OAAO,GAA8B,SAA0Bc,EAAQC,GAAU,IAAIC,EAAYhB,OAAOc,GAAS,OAAOE,GAAYnB,MAAMkB,KAAYC,GAStWX,WAAW,OAAO,EAAE,EAAEN,KAAKD,QAAQC,MAAM,GAAG,GAAG,IACzCI,OAAOjB,OAAO,GAAE,CAAC,IAAIrB,KAAKsC,OAAOc,MAAUhD,MAAMJ,KAAKI,MAAUE,IAAIN,KAAKM,IAAQD,IAAIL,KAAKK,IAAQE,KAAKP,KAAKO,KAAe,GAAVxB,IAAIiB,MAASA,KAAKG,UAAU,CACnJ,IAAIL,QAAQuC,MAAMvC,QAAQM,OAAOC,KAAK,IAAI,IAAIb,KAAKM,QAAQ,CAAC,IAAIuD,OAAOvD,QAAQN,GAAOsC,MAAM7C,MAAMoE,OAAOvB,OAAWC,KAAKsB,OAAOtB,KAAKA,KAAK/B,KAAKK,KAAK2B,MAAMW,MAAMvC,MAAME,KAAKgD,KAAK,KAAyB,iBAAVtD,KAAKY,KAAetB,QAAQU,KAAKY,KAAMkB,MAAM9B,KAAKK,KAAK0B,KAAK/B,KAAKK,KAAWyB,MAAM9B,KAAKK,KAAKpB,MAAMe,KAAKY,KAAM4B,WAAW,UAAUa,OAAOjD,MAAME,IAAI+C,OAAOhD,IAAIgD,OAAOxB,KAAKwB,OAAOzC,IAAIkB,MAAMC,YAAa,GAAGxB,KAAKnB,aAAaN,mCAAqD,EAAE,CAAC,IAAIyE,IAAIhD,KAAKC,QAC7dZ,SAASyC,MAAMzC,SAASU,KAAKiD,KAAK,IAAI,IAAI/D,KAAKI,SAAS,CAAC,IAAI4D,QAAQ5D,SAASJ,GAAOsC,MAAM7C,MAAMe,KAAK8B,OAAWC,KAAK/B,KAAK+B,KAAKD,MAAM0B,QAAQnD,KAAKpB,MAAMuE,QAAQ5C,KAAKmB,KAAKyB,QAAQnD,KAAKmD,QAAQzB,KAAKS,WAAW,UAAUpC,MAAMoD,QAAQlD,IAAID,IAAIL,KAAK6B,KAAK7B,KAAKY,IAAIkB,MAAMC,MAC1QwB,OAAOtB,SAAYM,iBAAiBgB,IAAIjD,MAAMkC,WAAW,UAAUlC,IAAIA,IAAIiD,IAAItB,QAAQsB,KAAK,GAAG,GAAG,SAAehD,MAAMyB,MAAM1B,MAChIkC,WAAW,OAAOpC,MAAME,IAAI,EAAED,IAAIL,KAAK6B,KAAK7B,KAAKY,IAAIZ,KAAK8B,MAAM9B,KAAK+B,MAAQ,OAAOM,QAI9EoB,GACA,SAAUhF,EAAQiF,EAAS/E,KAM3BgF,GACA,SAAUlF,EAAQC,EAAqBC,GAE7C,aAEAA,EAAoBiF,EAAElF,GAGtB,IAAImF,EAAgBlF,EAAoB,IAGpCmF,EAAgBnF,EAAoB,IASpCoF,GANSpF,EAAoB,IAGrBA,EAAoB,GAGhBA,EAAoB,KAGhCqF,EAAUrF,EAAoB,IAG9BsF,EAAUtF,EAAoB,GAG9BuF,EAAavF,EAAoB,IAGjCwF,EAAUxF,EAAoB,IAG9ByF,EAAOzF,EAAoB,GAkB+uB,SAAS0F,EAAsBC,GAA+C,IAAxC,IAAIC,EAAOD,EAAME,WAAeC,EAAK,GAAWjF,EAAE,EAAEA,EAAE+E,EAAOlD,OAAO7B,IAAK,GAAuB,GAApB+E,EAAO/E,GAAGkF,SAAY,CAAC,IAAI1F,EAAIuF,EAAO/E,GAAGmF,YAAYC,OAAe,IAAL5F,GAASyF,EAAKlG,KAAKS,EAAI6F,MAAM,YAAc,GAAuB,GAApBN,EAAO/E,GAAGkF,SAAa,GAAuB,SAApBH,EAAO/E,GAAGsF,SAAmBL,EAAKlG,KAAK6F,EAAkB,EAAEG,EAAO/E,GAAGmF,mBAAoB,GAAuB,WAApBJ,EAAO/E,GAAGsF,SAAoB,CAAC,IAAIC,EAAIR,EAAO/E,GAAGwF,aAAa,OAAOP,EAAKlG,KAAK6F,EAAkB,EAAEW,EAAIpC,MAAM,UAAW,GAAuB,OAApB4B,EAAO/E,GAAGsF,SAAiBL,EAAKlG,KAAK6F,EAAkB,EAAEG,EAAO/E,GAAGmF,YAAYC,cAAe,GAAuB,UAApBL,EAAO/E,GAAGsF,SAAoBL,EAAKlG,KAAK6F,EAAoB,EAAEC,EAAsBE,EAAO/E,WAAY,GAAuB,QAApB+E,EAAO/E,GAAGsF,SAAiB,CAAC,IAAIG,EAAOV,EAAO/E,GAAGwF,aAAa,UAAU,GAAIC,EAAyD,CAAC,IAAIrB,EAAEqB,EAAOJ,MAAM,KAASjC,EAAIsC,SAAStB,EAAE,IAAQf,EAAIqC,SAAStB,EAAE,IAAIf,EAAIA,GAAQsC,EAAAA,EAASV,EAAKlG,KAAK6F,EAAqB,EAAExB,EAAIC,EAAIwB,EAAsBE,EAAO/E,WAAnNiF,EAAKlG,KAAK8F,EAAsBE,EAAO/E,UAAyL4F,QAAQC,IAAId,EAAO/E,IAAO,OAAOiF,EAU9vD,IAAIa,EAAc3G,EAAoB,IAGtC,MAGM4G,EAhB0a,SAAqBvG,GAA0L,IAArL,IAAIwG,EAAszC,SAAkBzD,GAAM,GAAqB,oBAAX0D,UACtyD,OAAO,IAAIA,WAAYC,gBAAgB3D,EAAK,mBAAyB,GAAyB,oBAAf4D,cAA2B,CAC1G,IAAIC,EAAIC,IAAIC,cAEZ,OADAF,EAAIG,QAAQhE,GACL6D,EAIP,IAAII,EAAI,+BAA+BC,mBAAmBlE,GAAUmE,EAAQ,IAAIC,eAAkE,OAAjDD,EAAQE,KAAK,MAAMJ,GAAI,GAAOE,EAAQG,KAAK,MAAaH,EAAQI,YARiTC,CAASvH,GAASkD,EAAKsD,EAAIgB,qBAAqB,WAAW,GAAGxB,aAAa,QAAY/C,EAAQ,IAAImC,EAAsB,EAAElC,GAAUuE,EAAOjB,EAAIgB,qBAAqB,QAAgB5C,EAAE,EAAEA,EAAE6C,EAAOpF,OAAOuC,IAAI,CAAC,IAAIU,EAAMmC,EAAO7C,GAAmC3B,EAAzBqC,EAAMU,aAAa,OAAkBX,EAAsBC,GAAQ,OAAOrC,EAgB1vByE,CAHgB,y1EAG2LC,EAApEC,OAAOtB,EAA2B,EAAlCsB,CAAzF,+EAAoI/B,MAAM,OAAOU,GAAuB9E,eAAe8E,EAAKnD,OAAO,GAAGgD,QAAQC,IAAIsB,GAAQ,MAAME,EAAUD,OAAO3C,EAAsB,EAA7B2C,EAAgCE,IAAS,CAAEC,KAAK,QAAQC,MAAM,iBAAiBjG,OAAO+F,EAAQG,eAAc,SAASC,EAAInF,GAAM,OAAO6E,OAAO3C,EAAsB,EAA7B2C,EAAgCO,IAAU,CAAEJ,KAAK,QAAQC,MAAMjF,MAAgL,MAAMqF,EAAU,CAACC,QAAQ,OAAOC,OAAO,CAACC,KAAK,CAACC,GAAG,CAACC,MAAM,YAAYC,QAAQd,OAAO9C,EAA+B,EAAtC8C,CAAyC,CAACY,GAAG,CAACG,WAAW,CAAC,CAACC,OAAO,OAAOC,KAAKf,GAA6B,SAApBA,EAAQG,WAAoB,CAACW,OAAO,eAAxVE,EAAmX,qBAArW,CAACT,QAAQ,SAASC,OAAO,CAACQ,OAAO,CAACC,MAAMb,EAAIY,GAAQN,GAAG,CAACQ,UAAU,QAAQC,IAAI,CAACF,MAAMnB,OAAO3C,EAAsB,EAA7B2C,CAAgC,eAAuQsB,KAAK,CAACH,MAAMb,EAAI,MAAMiB,OAAO,QAAQC,QAAQ,CAACf,QAAQ,SAASC,OAAO,CAACQ,OAAO,CAACC,MAAMlB,EAAUW,GAAG,CAACQ,UAAU,YAAYI,QAAQ,CAACL,MAAM,eAAeI,OAAO,wBAA9jB,IAAsBL,EAEngBO,EAAO1J,EAAoB,IAG3B2J,EAAc3J,EAAoB,IAGtCiI,OAAOzC,EAAyB,EAAhCyC,CAAmC,CAACZ,IAAI,iCAAiCuC,QAAO,IAAQ,MAAMC,EAAQ5B,OAAO5C,EAAyB,EAAhC4C,CAAmC,CAAC6B,GAAG,OAAO1B,KAAK,WAAWO,OAAO,CAACoB,GAAG9B,OAAO9C,EAA+B,EAAtC8C,CAAyC,GAAGQ,GAAWuB,OAAO,CAACtB,QAAQ,OAAOC,OAAO,CAACsB,KAAK,CAACpB,GAAG,CAACqB,OAAO,cAAcC,MAAM,CAAClB,OAAO,WAAW3D,QAAQ2C,OAAO3C,EAAwB,EAA/B2C,EAAkC,CAACO,EAAS4B,KAAe,CAACC,UAAUD,EAAM/B,aAAaiC,YAAY,CAAC5B,QAAQ,WAAWU,MAAM,WAAWmB,KAAK,UAAU1B,GAAG,CAAC2B,UAAU,CAAClF,QAAQ,CAAC,eAAe2C,OAAO3C,EAAwB,EAA/B2C,EAAkC,CAACO,EAAS4B,KAAe,CAAC9B,UAAU8B,EAAM/B,WAAWY,OAAO,UAAUD,WAAW,QAAQL,OAAO,CAAC8B,SAAS,GAAGC,MAAM,CAACtB,MAAMnB,OAAO3C,EAAsB,EAA7B2C,CAAgC,iBAAiB0C,SAAS,CAACvB,MAAM,WAAWP,GAAG,CAACQ,UAAU,aAAa,CAAC/D,QAAQ,CAACsF,aAAazC,IAAoD1B,QAAQC,IAAI,WAAWyB,EAAQG,YAAauC,KAAK,KAAKpE,QAAQC,IAAI,SAAUoE,UAAU3C,IAA4C1B,QAAQC,IAAI,kBAAkByB,EAAQ4C,QAAQC,OAAOC,UAAiBC,EAAeC,IAAQ,QAAO,GAAM,KAAKA,EAAMC,MAAMC,QAAQ,CAACrB,OAAO,gBAAgB,OAAmB/B,OAAO0B,EAAiB,IAAxB1B,CAA2B,SAASA,OAAO9C,EAA+B,EAAtC8C,CAAyCA,OAAO9C,EAA+B,EAAtC8C,CAAyC,CAACG,KAAK,SAASkD,UAAU,gBAAgBC,MAAM,CAACC,UAAU,uBAAuBL,GAAO,GAAG,CAACM,SAAS,kBAAkB,KAAKN,EAAMC,MAAMC,QAAQ,CAACrB,OAAO,aAAa,OAAmB/B,OAAO0B,EAAiB,IAAxB1B,CAA2B,SAASA,OAAO9C,EAA+B,EAAtC8C,CAAyCA,OAAO9C,EAA+B,EAAtC8C,CAAyC,CAACG,KAAK,SAASkD,UAAU,gBAAgBC,MAAM,CAACC,UAAU,0BAA0BL,GAAO,GAAG,CAACM,SAAS,iBAAiB,QAAQ,OAAmBxD,OAAO0B,EAAiB,IAAxB1B,CAA2B,SAASA,OAAO9C,EAA+B,EAAtC8C,CAAyCA,OAAO9C,EAA+B,EAAtC8C,CAAyC,CAACG,KAAK,SAASkD,UAAU,iBAAiBH,GAAO,GAAG,CAACM,SAAS,sBAAuB,SAASC,IAAM,MAAMC,EAAoB1D,OAAOyB,EAAyB,mBAAhCzB,CAAmC,CAAC2D,MAAM,KAAKlE,EAAK,gBAAiBmE,EAAMF,EAAoBE,MAAMC,EAAOH,EAAoBG,OAAmDC,GAAnCJ,EAAoBhB,SAAqC1C,OAAOyB,EAA2B,qBAAlCzB,CAAqC,CAAC+D,SAAShE,IAASN,EAAK,CAACU,KAAK,YAAYC,MAAML,QAAaiE,EAAOF,EAAsBE,OAAiD1C,GAAhCwC,EAAsBG,UAAeH,EAAsBxC,MAAW4C,EAAYlE,OAAO1C,EAA+B,EAAtC0C,CAAyC4B,EAAQ,CAACuC,UAAS,EAAK9G,QAAQ,CAAC+G,SAASpE,OAAO1C,EAA6B,EAApC0C,EAAuC,KAAKxB,QAAQC,IAAI,qCAAqCuF,EAAO,CAACK,gBAAe,EAAMC,YAAW,OAAUC,QAAQvE,OAAO1C,EAA6B,EAApC0C,EAAuC,KAAKxB,QAAQC,IAAI,wBAAwB6C,OAAUkD,aAAaxE,OAAO1C,EAA6B,EAApC0C,EAAuCE,IAAU1B,QAAQC,IAAI,iBAAiBgG,SAASC,KAAKpB,MAAMqB,WAAWzE,EAAQG,aAAauE,SAAS5E,OAAO1C,EAA6B,EAApC0C,EAAuC,CAACE,EAAQ2E,KAAUrG,QAAQC,IAAI,eAAemF,EAAM,CAACzI,KAAK+E,EAAQkC,eAAe0C,UAAU9E,OAAO1C,EAA6B,EAApC0C,EAAuC,CAACE,EAAQ2E,KAAUrG,QAAQC,IAAI,eAAeoF,UAGr/FkB,EAAa/E,OAAO/C,EAA+B,EAAtC+C,CAAyCkE,EAAY,GAAGc,EAAQD,EAAa,GAAGtF,EAAKsF,EAAa,GAAWA,EAAa,GAAG,OAAmB/E,OAAO0B,EAAiB,IAAxB1B,CAA2B,MAAM,CAACqD,UAAU,MAAMG,SAAsBxD,OAAO0B,EAAiB,IAAxB1B,CAA2BiD,EAAe,CAACE,MAAM6B,EAAQC,QAAQ,IAAIxF,EAAK,aAChU,MACmEyF,EAAYT,SAASU,eAAe,QAAQhI,EAAkB,OAAe6C,OAAO0B,EAAiB,IAAxB1B,CAA2ByD,EAAI,IAAIyB,IAInLE,EACA,SAAUvN,EAAQC,EAAqBC,GAE7C,aAmCA,SAASsN,EAAQ/J,GAAM5D,KAAK8D,MAAMF,EAAK5D,KAAK4N,KAAK,CAACC,EAAM,KAAK7N,KAAK8N,KAAK,GAAG9N,KAAK+N,QAAQ,GAAG/N,KAAKgO,OAAO,WAAW,IAAI,IAAI9M,KAAKlB,KAAM,GAAO,UAAJkB,GAAiB,WAAJA,EAAc,IAAI+M,EAAuBjO,KAAKkB,IAAK,MAAMgN,GAAKC,EAAe,+BAA+BjN,EAAE,IAAIgN,KAGnO,SAASE,EAAInJ,GAAK,OAAO,IAAIoJ,EAASpJ,GAAM,SAASqJ,EAAIC,GAAK,OAAO,IAAIC,EAASD,GAAM,SAASV,EAAMY,GAAc,OAAO,IAAIC,EAAWD,GAAe,SAASE,EAAOrK,EAAIC,EAAIqK,GAAU,OAAO,IAAIC,EAAYvK,EAAIC,EAAIqK,GAE9P,SAASP,EAAS1J,GAAS3E,KAAKkC,QAAQyC,EAAQ3E,KAAKoD,QAAQ,IAAIuB,EAAQ3E,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAAW,SAASoL,EAASD,GAAKvO,KAAKkC,QAAQqM,EAAIvO,KAAKoD,QAAQ,IAAImL,EAAI,IAAIvO,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAAW,SAASsL,EAAWD,GAAczO,KAAKkC,QAAQuM,EAAazO,KAAKoD,QAAQ,IAAIqL,EAAazJ,KAAK,KAAK,IAAIhF,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAAW,SAASyL,EAAYvK,EAAIC,EAAIqK,GAAU5O,KAAKsE,IAAIA,EAAItE,KAAKuE,IAAIA,EAAIvE,KAAKkC,QAAQ0M,EAAS5O,KAAKoD,QAAQpD,KAAKkC,QAAQ,IAAIlC,KAAKsE,IAAI,KAAKtE,KAAKuE,KAAKsC,EAAAA,EAAS,GAAG7G,KAAKuE,KAAK,IAAIvE,KAAKqD,SAAS,WAAoB,OAAOrD,KAAKoD,SAElnB,SAAS+K,EAAeW,EAAQC,GAAO,WAAUrK,GAAPqK,EAAwBC,UAAUF,GAAqBE,UAAUF,EAAQ,KAAKC,EAAMD,SAAW,SAASb,EAAuBW,GAAU,IAAyG,IAAI,IAAI1N,KAA1G0N,EAAS9N,cAAcS,OAAO4M,EAAe,yBAAyBS,EAAS9N,YAAYwK,MAAoBsD,EAAaA,EAAS1N,GAAGJ,aAAaS,MAAO0M,EAAuBW,EAAS1N,IAAa0N,EAAS1N,GAAGJ,aAAamO,QAAQL,EAAS1N,GAAGgO,iBAAoB,MAAMhB,GAAKC,EAAe,mCAAmCD,IAzCle7N,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOuN,KAGpEtN,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOgO,KACpE/N,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOkO,KACpEjO,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOyN,KACpExN,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOuO,KAEpEtO,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOiO,KACpEhO,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOoO,KACpEnO,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOsO,KACpErO,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOyO,KA8BsaR,EAASc,UAAUD,eAAe,WAA6BlP,KAAKkC,QAAQpB,cAAcmO,QAAQd,EAAe,qDAAqDnO,KAAKkC,QAAQpB,YAAYwK,OAASkD,EAASW,UAAUD,eAAe,WAA6BlP,KAAKkC,QAAQpB,cAAcmO,QAAQd,EAAe,qDAAqDnO,KAAKkC,QAAQpB,YAAYwK,OAASoD,EAAWS,UAAUD,eAAe,WAA0B,IAAiH,IAAI,IAAIhO,KAAlHlB,KAAKkC,QAAQpB,cAAcS,OAAO4M,EAAe,yBAAyBnO,KAAKkC,QAAQpB,YAAYwK,MAAoBtL,KAAKkC,QAAS+L,EAAuBjO,KAAKkC,QAAQhB,IAAM,MAAMgN,GAAKC,EAAe,8BAA8BD,KAAQW,EAAYM,UAAUD,eAAe,WAA0B,IAAOlP,KAAKsE,IAAIxD,cAAcsO,QAAQpP,KAAKuE,IAAIzD,cAAcsO,QAAQjB,EAAe,wCAAwCnO,KAAKsE,IAAIxD,YAAYwK,KAAK,IAAItL,KAAKuE,IAAIzD,YAAYwK,MAAY,GAAGtL,KAAKsE,KAAKtE,KAAKsE,KAAKtE,KAAKuE,KAAM4J,EAAe,mCAAmCnO,KAAKsE,IAAI,IAAItE,KAAKuE,KAAM0J,EAAuBjO,KAAKkC,SAAU,MAAMgM,GAAKC,EAAe,+BAA+BD,OAIhpD,CAAC,CAAC,GAAG,EAAE"},"input":"(this[\"webpackJsonpxstate-react-typescript-template\"] = this[\"webpackJsonpxstate-react-typescript-template\"] || []).push([[0],{\n\n/***/ 22:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return parse; });\n/* harmony import */ var _srgs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8);\n//\n//  chartparser.js\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\n//\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/ /* Mods by Torbjörn\r\n- Removed the toString() method from Object. Why does it still work?\r\n- Added a text variable (similar to rules). See \r\n*/ //////////////////////////////////////////////////////////////////////\n// a logging function\n//  - uncomment if you want to debug the parsing process\nfunction LOG(str){//console.log(\"\" + str);\n}//////////////////////////////////////////////////////////////////////\n// we need to be able to clone objects between different edges\n// borrowed from http://keithdevens.com/weblog/archive/2007/Jun/07/javascript.clone\nfunction clone(obj){if(obj==null||typeof obj!='object'){return obj;}var temp=new obj.constructor();for(var key in obj){temp[key]=clone(obj[key]);}return temp;}function isEmpty(ob){for(var i in ob){if(ob.hasOwnProperty(i)){return false;}}return true;}//////////////////////////////////////////////////////////////////////\n// parse chart\n// conceptually this is a set of edges, but it is optimized\nfunction Chart(numberOfWords){this.numberOfWords=numberOfWords;this.passives=new Array(numberOfWords);this.actives=new Array(numberOfWords);for(var i=0;i<=numberOfWords;i++){this.passives[i]={};this.actives[i]={};}// Chart.add(edge)\n// add the edge to the chart, return true if the chart was changed \n// (i.e. if the chart didn't already contain the edge)\nthis.add=function add(edge){var subchart,cat;if(edge.isPassive){subchart=this.passives[edge.start];cat=edge.lhs;}else{subchart=this.actives[edge.end];cat=edge.next.content;}if(!(cat in subchart)){subchart[cat]={};}if(edge in subchart[cat]){return false;}else{subchart[cat][edge]=edge;return true;}};// Chart.resultsForRule(lhs, start, end)\n// return all parse results for the given lhs, start, and end\n//  - start, end are optional; defaults to 0, numberOfWords\nthis.resultsForRule=function resultsForRule(lhs,start,end){start=start||0;end=end||numberOfWords;var results=[];var finalEdges=this.passives[start][lhs];for(var i in finalEdges){if(finalEdges[i].end==end){results.push(finalEdges[i].out);}}return results;};// Chart.allEdges() / Chart.allPassiveEdges() / Chart.allActiveEdges()\n// return an array of all (passive/active) edges in the chart\nthis.allEdges=function allEdges(){return this.allPassiveEdges().concat(this.allActiveEdges());};this.allPassiveEdges=function allPassiveEdges(){var edges=[];for(var i in this.passives)for(var j in this.passives[i])for(var k in this.passives[i][j])edges.push(this.passives[i][j][k]);return edges;};this.allActiveEdges=function allActiveEdges(){var edges=[];for(var i in this.actives)for(var j in this.actives[i])for(var k in this.actives[i][j])edges.push(this.actives[i][j][k]);return edges;};// Chart.statistics()\n// return the number of edges in the chart\nthis.statistics=function statistics(){var passives=this.allPassiveEdges().length;var actives=this.allActiveEdges().length;return{nrEdges:passives+actives,nrPassiveEdges:passives,nrActiveEdges:actives};};}//////////////////////////////////////////////////////////////////////\n// parse edges: passive and active\nfunction PassiveEdge(start,end,lhs,out){this.start=start;this.end=end;this.lhs=lhs;this.out=out;this.isPassive=true;var str=\"[\"+start+\"-\"+end+\"] $\"+lhs+\" := \"+out;this._string=str;this.toString=function toString(){return this._string;};}function ActiveEdge(start,end,lhs,next,rest,out,rules,text){this.start=start;this.end=end;this.lhs=lhs;this.next=next;this.rest=rest;this.out=out;this.rules=rules;this.text=text;this.isPassive=false;var str=\"<\"+start+\"-\"+end+\"> $\"+lhs+\" -> \"+next+\", \"+rest+\" := \"+out+\" <- \"+rules;this._string=str;this.toString=function toString(){return this._string;};}//////////////////////////////////////////////////////////////////////\n// the main parsing function: a simple top-down chartparser\n//  - 'words' is an array of strings\n//  - 'grammar' is a hash table of left-hand-sides mapping to arrays of right-hand-sides\n//  - 'root' is the starting category (a string)\n//    if unspecified, use the '$root' property of the grammar\n//  - 'filter' is an optional left-corner filter \n//    (a mapping from categories/rule-refs to words)\n//    if specified, it is used when predicting new edges\n// returns the final chart\nfunction parse(words,grammar,root,filter){if(!root){root=grammar.$root;}var chart=new Chart(words.length);var agenda=[];var leftCornerFilter;if(filter==undefined){leftCornerFilter=function leftCornerFilter(){return true;};}else{leftCornerFilter=function leftCornerFilter(ruleref,position){var leftCorners=filter[ruleref];return leftCorners?words[position]in leftCorners:true;};}// add an edge to the chart and the agenda, if it does not already exist\nfunction addToChart(inference,start,end,lhs,rhs,out,rules,text){var edge;if(rhs.length>0){var next=rhs[0];var rest=rhs.slice(1);switch(next.constructor){case Array:// the next symbol is a sequence\naddToChart(inference+\",SEQUENCE\",start,end,lhs,next.concat(rest),out,rules,text);return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* RepeatClass */ \"g\"]:// the next symbol is a repetition\nvar min=next.min;var max=next.max;// skip repeat \nif(min<=0){addToChart(inference+\",SKIP\",start,end,lhs,rest,out,rules,text);}// repeat \nif(max>0){var content=next.content;var rhs=max==1?[content]:[content,_srgs__WEBPACK_IMPORTED_MODULE_0__[/* Repeat */ \"f\"](min?min-1:min,max-1,content)];addToChart(inference+\",REPEAT\",start,end,lhs,rhs.concat(rest),out,rules,text);}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* OneOfClass */ \"c\"]:// the next symbol is a disjunction\nvar oneof=next.content;for(var i in oneof){var rhs=oneof[i].concat(rest);addToChart(inference+\",ONEOF\",start,end,lhs,rhs,out,rules,text);}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* TagClass */ \"i\"]:// the next symbol is a semantic action\nout=clone(out);rules=clone(rules);eval(next.content);addToChart(inference+\",TAG\",start,end,lhs,rest,out,rules,text);return;}edge=new ActiveEdge(start,end,lhs,next,rest,out,rules,text);}else{edge=new PassiveEdge(start,end,lhs,out);}// try to add the edge; if successful, also add it to the agenda\nif(chart.add(edge)){LOG(\"+ \"+inference+\": \"+edge);agenda.push(edge);}}// seed the agenda with the starting rule\naddToChart(\"INIT\",0,0,root,grammar[root],{},{},{});// main loop\nwhile(agenda.length>0){var edge=agenda.pop();var start=edge.start;var end=edge.end;var lhs=edge.lhs;var next=edge.next;LOG(edge);if(edge.isPassive){// combine\nvar actives=chart.actives[start][lhs];for(var i in actives){var active=actives[i];var rules=clone(active.rules);var text=active.text;text[edge.lhs]=words.slice(start,end).join(\" \");if(typeof edge.out=='object'&&isEmpty(edge.out)){rules[edge.lhs]=text[edge.lhs];}else{rules[edge.lhs]=clone(edge.out);}addToChart(\"COMBINE\",active.start,end,active.lhs,active.rest,active.out,rules,text);}}else if(next.constructor==_srgs__WEBPACK_IMPORTED_MODULE_0__[/* RefClass */ \"e\"]){var ref=next.content;// combine\nvar passives=chart.passives[end][ref];for(var i in passives){var passive=passives[i];var rules=clone(edge.rules);var text=edge.text;rules[passive.lhs]=clone(passive.out);text[passive.lhs]=passive.text;addToChart(\"COMBINE\",start,passive.end,lhs,edge.rest,edge.out,rules,text);}// predict\nif(ref in grammar){if(leftCornerFilter(ref,end)){addToChart(\"PREDICT\",end,end,ref,grammar[ref],{},{},{});}}}else if(next==words[end]){// scan\naddToChart(\"SCAN\",start,end+1,lhs,edge.rest,edge.out,edge.rules,edge.text);}}return chart;}\n\n/***/ }),\n\n/***/ 26:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 37:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 5 modules\nvar slicedToArray = __webpack_require__(25);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js + 1 modules\nvar objectSpread2 = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./src/styles.scss\nvar styles = __webpack_require__(26);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(7);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(21);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/Machine.js + 2 modules\nvar Machine = __webpack_require__(43);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/actions.js\nvar actions = __webpack_require__(4);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/react/es/useMachine.js + 3 modules\nvar useMachine = __webpack_require__(42);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/inspect/es/browser.js + 3 modules\nvar browser = __webpack_require__(41);\n\n// EXTERNAL MODULE: ./src/srgs.js\nvar srgs = __webpack_require__(8);\n\n// CONCATENATED MODULE: ./src/runparser.js\n//\n//  runparser.js\n//\n/*\r\n  The author or authors of this code dedicate any and all \r\n  copyright interest in this code to the public domain.\r\n*/ // helper functions for the parser demo\nfunction getElement(id){return document.getElementById(id);}function appendElement(parent,element,text){var elem=document.createElement(element);if(text)elem.appendChild(document.createTextNode(text));parent.appendChild(elem);return elem;}function runParser(input){var resultsDiv=getElement(\"results\");resultsDiv.innerHTML=\"\";var maybeFilter;if(getElement(\"usefilter\")&&getElement(\"usefilter\").checked){maybeFilter=filter;appendElement(resultsDiv,\"EM\",\"Using left-corner filter\");}var startTime=new Date();var parseChart=parse(input,grammar,grammar.$root,maybeFilter);var parseTime=new Date()-startTime;var parseResults=parseChart.resultsForRule(grammar.$root);console.log(parseResults[0]);if(parseResults){for(var i in parseResults){resultsDiv.innerHTML+=display(parseResults[i],\"\");}}else{appendElement(resultsDiv,\"P\",\"No results found!\");}/*\r\n  if (parseResults) { \r\n    var resultList = appendElement(resultsDiv, \"OL\");\r\n    for (var i in parseResults) \r\n      appendElement(resultList, \"LI\", JSON.stringify(parseResults[i]));\r\n  } else {\r\n    appendElement(resultsDiv, \"P\", \"No results found!\");\r\n  }\r\n*/var statistics=parseChart.statistics();appendElement(resultsDiv,\"P\",\"Chart size: \"+statistics.nrEdges+\" edges\"+\" (\"+statistics.nrPassiveEdges+\" passive)\");appendElement(resultsDiv,\"P\",\"Parse time: \"+parseTime+\" ms\"+\" (\"+(parseTime/statistics.nrEdges).toFixed(2)+\" ms/edge)\");}function runWordParser(){runParser(getElement(\"input\").value.split(/\\s+/));}function runCharacterParser(){runParser(getElement(\"input\").value.split(\"\"));}function loadGrammar(str){var dom=parseXML(str);var root=dom.getElementsByTagName(\"grammar\")[0].getAttribute(\"root\");var grammar=new srgs[\"a\" /* Grammar */](root);var xrules=dom.getElementsByTagName(\"rule\");for(var r=0;r<xrules.length;r++){var xrule=xrules[r];var id=xrule.getAttribute(\"id\");grammar[id]=processRuleExpansions(xrule);}return grammar;}function processRuleExpansions(xrule){var xitems=xrule.childNodes;var rule=[];for(var i=0;i<xitems.length;i++){if(xitems[i].nodeType==3){var str=xitems[i].textContent.trim();if(str!=\"\"){rule.push(str.split(/ +/));}}else if(xitems[i].nodeType==1){if(xitems[i].nodeName==\"token\"){rule.push(srgs[\"h\" /* Tag */](xitems[i].textContent));}else if(xitems[i].nodeName==\"ruleref\"){var uri=xitems[i].getAttribute(\"uri\");rule.push(srgs[\"d\" /* Ref */](uri.slice(1)));}else if(xitems[i].nodeName==\"tag\"){rule.push(srgs[\"h\" /* Tag */](xitems[i].textContent.trim()));}else if(xitems[i].nodeName==\"one-of\"){rule.push(srgs[\"b\" /* OneOf */](processRuleExpansions(xitems[i])));}else if(xitems[i].nodeName==\"item\"){var repeat=xitems[i].getAttribute(\"repeat\");if(!repeat){rule.push(processRuleExpansions(xitems[i]));}else{var r=repeat.split(\"-\");var min=parseInt(r[0]);var max=parseInt(r[1]);max=max?max:Infinity;rule.push(srgs[\"f\" /* Repeat */](min,max,processRuleExpansions(xitems[i])));}}else{console.log(xitems[i]);}}}return rule;}function parseXML(text){if(typeof DOMParser!=\"undefined\"){// Mozilla, Firefox, and related browsers\nreturn new DOMParser().parseFromString(text,\"application/xml\");}else if(typeof ActiveXObject!=\"undefined\"){// Internet Explorer.\nvar doc=XML.newDocument();// Create an empty document\ndoc.loadXML(text);// Parse text into it\nreturn doc;// Return it\n}else{// As a last resort, try loading the document from a data: URL\n// This is supposed to work in Safari. Thanks to Manos Batsis and\n// his Sarissa library (sarissa.sourceforge.net) for this technique.\nvar url=\"data:text/xml;charset=utf-8,\"+encodeURIComponent(text);var request=new XMLHttpRequest();request.open(\"GET\",url,false);request.send(null);return request.responseXML;}};\n// EXTERNAL MODULE: ./src/chartparser.js\nvar chartparser = __webpack_require__(22);\n\n// CONCATENATED MODULE: ./src/grammars/pizzaGrammar.ts\nconst pizzaGrammar_grammar=\"\\n<grammar root=\\\"order\\\">\\n   <rule id=\\\"order\\\">\\n      I would like a\\n      <ruleref uri=\\\"#drink\\\"/>\\n      <tag>out.drink = new Object(); out.drink.liquid=rules.drink.type;\\n           out.drink.drinksize=rules.drink.drinksize;</tag>\\n      and\\n      <ruleref uri=\\\"#pizza\\\"/>\\n      <tag>out.pizza=rules.pizza;</tag>\\n   </rule>\\n   <rule id=\\\"kindofdrink\\\">\\n      <one-of>\\n         <item>coke</item>\\n         <item>pepsi</item>\\n         <item>coca cola<tag>out=\\\"coke\\\";</tag></item>\\n      </one-of>\\n   </rule>\\n   <rule id=\\\"foodsize\\\">\\n      <tag>out=\\\"medium\\\";</tag> <!-- \\\"medium\\\" is default if nothing said -->\\n      <item repeat=\\\"0-1\\\">\\n         <one-of>\\n            <item>small<tag>out=\\\"small\\\";</tag></item>\\n            <item>medium</item>\\n            <item>large<tag>out=\\\"large\\\";</tag></item>\\n            <item>regular<tag>out=\\\"medium\\\";</tag></item>\\n         </one-of>\\n      </item>\\n   </rule>\\n   <!-- Construct Array of toppings, return Array -->\\n   <rule id=\\\"tops\\\">\\n      <tag>out=new Array;</tag>\\n      <ruleref uri=\\\"#top\\\"/>\\n      <tag>out.push(rules.top);</tag>\\n      <item repeat=\\\"1-\\\">\\n         and\\n         <ruleref uri=\\\"#top\\\"/>\\n         <tag>out.push(rules.top);</tag>\\n      </item>\\n   </rule>\\n   <rule id=\\\"top\\\">\\n      <one-of>\\n         <item>anchovies</item>\\n         <item>pepperoni</item>\\n         <item>mushroom<tag>out=\\\"mushrooms\\\";</tag></item>\\n         <item>mushrooms</item>\\n      </one-of>\\n   </rule>\\n   <!-- Two properties (drinksize, type) on left hand side Rule Variable -->\\n   <rule id=\\\"drink\\\">\\n      <ruleref uri=\\\"#foodsize\\\"/>\\n      <ruleref uri=\\\"#kindofdrink\\\"/>\\n      <tag>out.drinksize=rules.foodsize; out.type=rules.kindofdrink;</tag>\\n   </rule>\\n   <!-- Three properties on rules.pizza -->\\n   <rule id=\\\"pizza\\\">\\n      <ruleref uri=\\\"#number\\\"/>\\n      <ruleref uri=\\\"#foodsize\\\"/>\\n      <tag>out.pizzasize=rules.foodsize; out.number=rules.number;</tag>\\n      pizzas with\\n      <ruleref uri=\\\"#tops\\\"/>\\n      <tag>out.topping=rules.tops;</tag>\\n   </rule>\\n   <rule id=\\\"number\\\">\\n      <one-of>\\n         <item>\\n            <tag>out=1;</tag>\\n            <one-of>\\n               <item>a</item>\\n               <item>one</item>\\n            </one-of>\\n         </item>\\n         <item>two<tag>out=2;</tag></item>\\n         <item>three<tag>out=3;</tag></item>\\n      </one-of>\\n   </rule>\\n</grammar>\\n\";\n// CONCATENATED MODULE: ./src/dmColourChanger.ts\n// SRGS parser and example (logs the results to console on page load)\nconst gram=loadGrammar(pizzaGrammar_grammar);const input=\"I would like a coca cola and three large pizzas with pepperoni and mushrooms\";const prs=Object(chartparser[\"a\" /* parse */])(input.split(/\\s+/),gram);const result=prs.resultsForRule(gram.$root)[0];console.log(result);const sayColour=Object(actions[\"k\" /* send */])(context=>({type:\"SPEAK\",value:\"Repainting to \".concat(context.recResult)}));function say(text){return Object(actions[\"k\" /* send */])(_context=>({type:\"SPEAK\",value:text}));}function promptAndAsk(prompt){return{initial:'prompt',states:{prompt:{entry:say(prompt),on:{ENDSPEECH:'ask'}},ask:{entry:Object(actions[\"k\" /* send */])('LISTEN')}}};}const dmMachine={initial:'init',states:{init:{on:{CLICK:'welcome'}},welcome:Object(objectSpread2[\"a\" /* default */])({on:{RECOGNISED:[{target:'stop',cond:context=>context.recResult==='stop'},{target:'repaint'}]}},promptAndAsk(\"Tell me the colour\")),stop:{entry:say(\"Ok\"),always:'init'},repaint:{initial:'prompt',states:{prompt:{entry:sayColour,on:{ENDSPEECH:'repaint'}},repaint:{entry:'changeColour',always:'#root.dm.welcome'}}}}};\n// EXTERNAL MODULE: ./node_modules/react-speech-kit/dist/index.js\nvar dist = __webpack_require__(20);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(13);\n\n// CONCATENATED MODULE: ./src/index.tsx\nObject(browser[\"a\" /* inspect */])({url:\"https://statecharts.io/inspect\",iframe:false});const machine=Object(Machine[\"a\" /* Machine */])({id:'root',type:'parallel',states:{dm:Object(objectSpread2[\"a\" /* default */])({},dmMachine),asrtts:{initial:'idle',states:{idle:{on:{LISTEN:'recognising',SPEAK:{target:'speaking',actions:Object(actions[\"b\" /* assign */])((_context,event)=>{return{ttsAgenda:event.value};})}}},recognising:{initial:'progress',entry:'recStart',exit:'recStop',on:{ASRRESULT:{actions:['recLogResult',Object(actions[\"b\" /* assign */])((_context,event)=>{return{recResult:event.value};})],target:'.match'},RECOGNISED:'idle'},states:{progress:{},match:{entry:Object(actions[\"k\" /* send */])('RECOGNISED')}}},speaking:{entry:'ttsStart',on:{ENDSPEECH:'idle'}}}}}},{actions:{recLogResult:context=>{/* context.recResult = event.recResult; */console.log('<< ASR: '+context.recResult);},test:()=>{console.log('test');},logIntent:context=>{/* context.nluData = event.data */console.log('<< NLU intent: '+context.nluData.intent.name);}}});const ReactiveButton=props=>{switch(true){case props.state.matches({asrtts:'recognising'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},props),{},{children:\"Listening...\"}));case props.state.matches({asrtts:'speaking'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},props),{},{children:\"Speaking...\"}));default:return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\"},props),{},{children:\"Click to start\"}));}};function App(){const _useSpeechSynthesis=Object(dist[\"useSpeechSynthesis\"])({onEnd:()=>{send('ENDSPEECH');}}),speak=_useSpeechSynthesis.speak,cancel=_useSpeechSynthesis.cancel,speaking=_useSpeechSynthesis.speaking;const _useSpeechRecognition=Object(dist[\"useSpeechRecognition\"])({onResult:result=>{send({type:\"ASRRESULT\",value:result});}}),listen=_useSpeechRecognition.listen,listening=_useSpeechRecognition.listening,stop=_useSpeechRecognition.stop;const _useMachine=Object(useMachine[\"b\" /* useMachine */])(machine,{devTools:true,actions:{recStart:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('Ready to receive a color command.');listen({interimResults:false,continuous:true});}),recStop:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('Recognition stopped.');stop();}),changeColour:Object(useMachine[\"a\" /* asEffect */])(context=>{console.log('Repainting...');document.body.style.background=context.recResult;}),ttsStart:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('Speaking...');speak({text:context.ttsAgenda});}),ttsCancel:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('TTS STOP...');cancel();})/* speak: asEffect((context) => {\r\n\t     * console.log('Speaking...');\r\n             *     speak({text: context.ttsAgenda })\r\n             * } */}}),_useMachine2=Object(slicedToArray[\"a\" /* default */])(_useMachine,3),current=_useMachine2[0],send=_useMachine2[1],service=_useMachine2[2];return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"App\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ReactiveButton,{state:current,onClick:()=>send('CLICK')})});};/* RASA API\r\n *  */const proxyurl=\"https://cors-anywhere.herokuapp.com/\";const rasaurl='https://rasa-nlu-api-00.herokuapp.com/model/parse';const nluRequest=text=>fetch(new Request(proxyurl+rasaurl,{method:'POST',headers:{'Origin':'http://maraev.me'},// only required with proxy\nbody:\"{\\\"text\\\": \\\"\".concat(text,\"\\\"}\")})).then(data=>data.json());const rootElement=document.getElementById(\"root\");react_dom[\"render\"](/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App,{}),rootElement);\n\n/***/ }),\n\n/***/ 8:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Grammar; });\n/* unused harmony export WordSet */\n/* unused harmony export Sequence */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return Ref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"h\", function() { return Tag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return OneOf; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return Repeat; });\n/* unused harmony export Optional */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return RefClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"i\", function() { return TagClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return OneOfClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return RepeatClass; });\n/* unused harmony export throwRuleError */\n/* unused harmony export checkSequenceExpansion */\n//\n//  srgs.js\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\n//\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/ //////////////////////////////////////////////////////////////////////\n// encoding SRGS grammars in javascript\nfunction Grammar(root){this.$root=root;this.VOID=[OneOf([])];this.NULL=[];this.GARBAGE=[];this.$check=function(){for(var i in this){if(i!==\"$root\"&&i!==\"$check\"){try{checkSequenceExpansion(this[i]);}catch(err){throwRuleError(\"When checking grammar rule '\"+i+\"'\",err);}}}};}function WordSet(str){var words=str.split(/ +/);var set={};for(var i in words){set[words[i]]=true;}return set;}//////////////////////////////////////////////////////////////////////\n// rule expansion constructors\n// sequences are ordinary arrays\nfunction Sequence(seq){return seq;}function Ref(ref){return new RefClass(ref);}function Tag(tag){return new TagClass(tag);}function OneOf(alternatives){return new OneOfClass(alternatives);}function Repeat(min,max,sequence){return new RepeatClass(min,max,sequence);}function Optional(sequence){return new RepeatClass(0,1,sequence);}//////////////////////////////////////////////////////////////////////\n// rule expansion classes\nfunction RefClass(ruleref){this.content=ruleref;this._string=\"$\"+ruleref;this.toString=function toString(){return this._string;};}function TagClass(tag){this.content=tag;this._string=\"{\"+tag+\"}\";this.toString=function toString(){return this._string;};}function OneOfClass(alternatives){this.content=alternatives;this._string=\"(\"+alternatives.join(\"|\")+\")\";this.toString=function toString(){return this._string;};}function RepeatClass(min,max,sequence){this.min=min;this.max=max;this.content=sequence;this._string=this.content+\"<\"+this.min+\"-\"+(this.max==Infinity?\"\":this.max)+\">\";this.toString=function toString(){return this._string;};}//////////////////////////////////////////////////////////////////////\n// checking rule expansions\nfunction throwRuleError(message,error){if(error==undefined){throw TypeError(message);}else{throw TypeError(message+\"; \"+error.message);}}function checkSequenceExpansion(sequence){try{if(sequence.constructor!==Array){throwRuleError(\"Expected Array, found \"+sequence.constructor.name);}for(var i in sequence){if(sequence[i].constructor==Array){checkSequenceExpansion(sequence[i]);}else if(sequence[i].constructor!=String){sequence[i].checkExpansion();}}}catch(err){throwRuleError(\"When checking sequence expansion\",err);}};RefClass.prototype.checkExpansion=function checkExpansion(){if(this.content.constructor!==String){throwRuleError(\"When checking Ref content; Expected String, found \"+this.content.constructor.name);}};TagClass.prototype.checkExpansion=function checkExpansion(){if(this.content.constructor!==String){throwRuleError(\"When checking Tag content; Expected String, found \"+this.content.constructor.name);}};OneOfClass.prototype.checkExpansion=function checkExpansion(){try{if(this.content.constructor!==Array){throwRuleError(\"Expected Array, found \"+this.content.constructor.name);}for(var i in this.content){checkSequenceExpansion(this.content[i]);}}catch(err){throwRuleError(\"When checking OneOf content\",err);}};RepeatClass.prototype.checkExpansion=function checkExpansion(){try{if(this.min.constructor!==Number||this.max.constructor!==Number){throwRuleError(\"Expected min/max to be Number, found \"+this.min.constructor.name+\"/\"+this.max.constructor.name);}if(!(0<=this.min&&this.min<=this.max)){throwRuleError(\"Expected 0 <= min <= max, found \"+this.min+\"/\"+this.max);}checkSequenceExpansion(this.content);}catch(err){throwRuleError(\"When checking Repeat content\",err);}};\n\n/***/ })\n\n},[[37,1,2]]]);","inputSourceMap":{"version":3,"sources":["C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/chartparser.js","C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-6-0!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-6-1!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\postcss-loader\\src\\index.js??postcss!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\resolve-url-loader\\index.js??ref--5-oneOf-6-3!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\sass-loader\\dist\\cjs.js??ref--5-oneOf-6-4!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\src\\styles.scss","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/runparser.js","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/grammars/pizzaGrammar.ts","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/dmColourChanger.ts","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/index.tsx","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/srgs.js"],"names":["LOG","str","clone","obj","temp","constructor","key","isEmpty","ob","i","hasOwnProperty","Chart","numberOfWords","passives","Array","actives","add","edge","subchart","cat","isPassive","start","lhs","end","next","content","resultsForRule","results","finalEdges","push","out","allEdges","allPassiveEdges","concat","allActiveEdges","edges","j","k","statistics","length","nrEdges","nrPassiveEdges","nrActiveEdges","PassiveEdge","_string","toString","ActiveEdge","rest","rules","text","parse","words","grammar","root","filter","$root","chart","agenda","leftCornerFilter","undefined","ruleref","position","leftCorners","addToChart","inference","rhs","slice","SRGS","min","max","oneof","eval","pop","active","join","ref","passive","getElement","id","document","getElementById","appendElement","parent","element","elem","createElement","appendChild","createTextNode","runParser","input","resultsDiv","innerHTML","maybeFilter","checked","startTime","Date","parseChart","parseTime","parseResults","console","log","display","toFixed","runWordParser","value","split","runCharacterParser","loadGrammar","dom","parseXML","getElementsByTagName","getAttribute","xrules","r","xrule","processRuleExpansions","xitems","childNodes","rule","nodeType","textContent","trim","nodeName","uri","repeat","parseInt","Infinity","DOMParser","parseFromString","ActiveXObject","doc","XML","newDocument","loadXML","url","encodeURIComponent","request","XMLHttpRequest","open","send","responseXML","gram","prs","result","sayColour","context","type","recResult","say","_context","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","dmMachine","init","CLICK","welcome","RECOGNISED","target","cond","stop","always","repaint","inspect","iframe","machine","Machine","dm","asrtts","idle","LISTEN","SPEAK","actions","assign","event","ttsAgenda","recognising","exit","ASRRESULT","progress","match","speaking","recLogResult","test","logIntent","nluData","intent","name","ReactiveButton","props","state","matches","animation","App","useSpeechSynthesis","onEnd","speak","cancel","useSpeechRecognition","onResult","listen","listening","useMachine","devTools","recStart","asEffect","interimResults","continuous","recStop","changeColour","body","style","background","ttsStart","effect","ttsCancel","current","service","proxyurl","rasaurl","nluRequest","fetch","Request","method","headers","then","data","json","rootElement","ReactDOM","Grammar","VOID","OneOf","NULL","GARBAGE","$check","checkSequenceExpansion","err","throwRuleError","WordSet","set","Sequence","seq","Ref","RefClass","Tag","tag","TagClass","alternatives","OneOfClass","Repeat","sequence","RepeatClass","Optional","message","error","TypeError","String","checkExpansion","prototype","Number"],"mappings":"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","file":"x","sourcesContent":["//\r\n//  chartparser.js\r\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\r\n//\r\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n/* Mods by Torbjörn\r\n- Removed the toString() method from Object. Why does it still work?\r\n- Added a text variable (similar to rules). See \r\n*/\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// a logging function\r\n//  - uncomment if you want to debug the parsing process\r\nfunction LOG(str) {\r\n  //console.log(\"\" + str);\r\n}\r\n\r\nimport * as SRGS from './srgs'\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// we need to be able to clone objects between different edges\r\n// borrowed from http://keithdevens.com/weblog/archive/2007/Jun/07/javascript.clone\r\nfunction clone(obj){\r\n  if (obj == null || typeof(obj) != 'object') {\r\n    return obj;\r\n  }\r\n  var temp = new obj.constructor(); \r\n  for (var key in obj) {\r\n    temp[key] = clone(obj[key]);\r\n  }\r\n  return temp;\r\n}\r\n\r\n\r\nfunction isEmpty(ob){\r\n   for (var i in ob) { if(ob.hasOwnProperty(i)) {return false;}}\r\n  return true;\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// parse chart\r\n// conceptually this is a set of edges, but it is optimized\r\nfunction Chart(numberOfWords) {\r\n  this.numberOfWords = numberOfWords;\r\n  this.passives = new Array(numberOfWords);\r\n  this.actives = new Array(numberOfWords);\r\n  for (var i = 0; i <= numberOfWords; i++) {\r\n    this.passives[i] = {};\r\n    this.actives[i] = {};\r\n  }\r\n\r\n  // Chart.add(edge)\r\n  // add the edge to the chart, return true if the chart was changed \r\n  // (i.e. if the chart didn't already contain the edge)\r\n  this.add = function add(edge) {\r\n    var subchart, cat;\r\n    if (edge.isPassive) {\r\n      subchart = this.passives[edge.start];\r\n      cat = edge.lhs;\r\n    } else {\r\n      subchart = this.actives[edge.end];\r\n      cat = edge.next.content;\r\n    }\r\n    if (!(cat in subchart)) {\r\n      subchart[cat] = {};\r\n    }\r\n    if (edge in subchart[cat]) {\r\n      return false;\r\n    } else {\r\n      subchart[cat][edge] = edge;\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // Chart.resultsForRule(lhs, start, end)\r\n  // return all parse results for the given lhs, start, and end\r\n  //  - start, end are optional; defaults to 0, numberOfWords\r\n  this.resultsForRule = function resultsForRule(lhs, start, end) {\r\n    start = start || 0;\r\n    end = end || numberOfWords;\r\n    var results = [];\r\n    var finalEdges = this.passives[start][lhs];\r\n    for (var i in finalEdges) {\r\n      if (finalEdges[i].end == end) {\r\n\tresults.push(finalEdges[i].out);\r\n      }\r\n    }\r\n    return results;\r\n  }\r\n  \r\n  // Chart.allEdges() / Chart.allPassiveEdges() / Chart.allActiveEdges()\r\n  // return an array of all (passive/active) edges in the chart\r\n  this.allEdges = function allEdges() {\r\n    return this.allPassiveEdges().concat(this.allActiveEdges());\r\n  }\r\n  this.allPassiveEdges = function allPassiveEdges() {\r\n    var edges = [];\r\n    for (var i in this.passives) \r\n      for (var j in this.passives[i]) \r\n\tfor (var k in this.passives[i][j])\r\n\t  edges.push(this.passives[i][j][k]);\r\n    return edges;\r\n  }\r\n  this.allActiveEdges = function allActiveEdges() {\r\n    var edges = [];\r\n    for (var i in this.actives) \r\n      for (var j in this.actives[i]) \r\n\tfor (var k in this.actives[i][j])\r\n\t  edges.push(this.actives[i][j][k]);\r\n    return edges;\r\n  }\r\n\r\n  // Chart.statistics()\r\n  // return the number of edges in the chart\r\n  this.statistics = function statistics() {\r\n    var passives = this.allPassiveEdges().length;\r\n    var actives = this.allActiveEdges().length;\r\n    return {nrEdges: passives+actives, nrPassiveEdges: passives, nrActiveEdges: actives};\r\n  }\r\n}\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// parse edges: passive and active\r\n\r\nfunction PassiveEdge(start, end, lhs, out) {\r\n  this.start = start;\r\n  this.end = end;\r\n  this.lhs = lhs;\r\n  this.out = out;\r\n  this.isPassive = true;\r\n\r\n  var str = \"[\" + start + \"-\" + end + \"] $\" + lhs + \" := \" + out;\r\n  this._string = str;\r\n  this.toString = function toString() {return this._string;} \r\n}\r\n\r\nfunction ActiveEdge(start, end, lhs, next, rest, out, rules, text) {\r\n  this.start = start;\r\n  this.end = end;\r\n  this.lhs = lhs;\r\n  this.next = next;\r\n  this.rest = rest;\r\n  this.out = out;\r\n  this.rules = rules;\r\n  this.text = text;\r\n  this.isPassive = false;\r\n\r\n  var str = \"<\" + start + \"-\" + end + \"> $\" + lhs + \" -> \" + next + \r\n    \", \" + rest + \" := \" + out + \" <- \" + rules;\r\n  this._string = str;\r\n  this.toString = function toString() {return this._string;} \r\n}\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// the main parsing function: a simple top-down chartparser\r\n//  - 'words' is an array of strings\r\n//  - 'grammar' is a hash table of left-hand-sides mapping to arrays of right-hand-sides\r\n//  - 'root' is the starting category (a string)\r\n//    if unspecified, use the '$root' property of the grammar\r\n//  - 'filter' is an optional left-corner filter \r\n//    (a mapping from categories/rule-refs to words)\r\n//    if specified, it is used when predicting new edges\r\n// returns the final chart\r\nexport function parse(words, grammar, root, filter) {\r\n  if (!root) {\r\n    root = grammar.$root;\r\n  }\r\n  var chart = new Chart(words.length);\r\n  var agenda = [];\r\n\r\n  var leftCornerFilter;\r\n  if (filter == undefined) {\r\n    leftCornerFilter = function() {return true};\r\n  } else {\r\n    leftCornerFilter = function leftCornerFilter(ruleref, position) {\r\n      var leftCorners = filter[ruleref];\r\n      return leftCorners ? words[position] in leftCorners : true;\r\n    }\r\n  }\r\n  \r\n  // add an edge to the chart and the agenda, if it does not already exist\r\n  function addToChart(inference, start, end, lhs, rhs, out, rules, text) {\r\n    var edge;\r\n    if (rhs.length > 0) {\r\n      var next = rhs[0];\r\n      var rest = rhs.slice(1);\r\n      switch (next.constructor) {\r\n\t\r\n      case Array:\r\n\t// the next symbol is a sequence\r\n\taddToChart(inference+\",SEQUENCE\", start, end, lhs, next.concat(rest), out, rules, text);\r\n\treturn;\r\n\t\r\n      case SRGS.RepeatClass:\r\n\t// the next symbol is a repetition\r\n\tvar min = next.min;\r\n\tvar max = next.max;\r\n\t// skip repeat \r\n\tif (min <= 0) {\r\n\t  addToChart(inference+\",SKIP\", start, end, lhs, rest, out, rules, text);\r\n\t}\r\n\t// repeat \r\n\tif (max > 0) {\r\n\t  var content = next.content;\r\n\t  var rhs = (max==1 ? [content] : [content, SRGS.Repeat(min ? min-1 : min, max-1, content)]);\r\n\t  addToChart(inference+\",REPEAT\", start, end, lhs, rhs.concat(rest), out, rules, text);\r\n\t}\r\n\treturn;\r\n\t\r\n      case SRGS.OneOfClass:\r\n\t// the next symbol is a disjunction\r\n\tvar oneof = next.content;\r\n\tfor (var i in oneof) {\r\n\t  var rhs = oneof[i].concat(rest);\r\n\t  addToChart(inference+\",ONEOF\", start, end, lhs, rhs, out, rules, text);\r\n\t} \r\n\treturn;\r\n\t\r\n      case SRGS.TagClass:\r\n\t// the next symbol is a semantic action\r\n\tout = clone(out);\r\n\trules = clone(rules);\r\n\teval(next.content);\r\n\taddToChart(inference+\",TAG\", start, end, lhs, rest, out, rules, text);\r\n\treturn;\r\n      }\r\n\r\n      edge = new ActiveEdge(start, end, lhs, next, rest, out, rules, text);\r\n    } else {\r\n      edge = new PassiveEdge(start, end, lhs, out);\r\n    }\r\n    \r\n    // try to add the edge; if successful, also add it to the agenda\r\n    if (chart.add(edge)) {\r\n      LOG(\"+ \" + inference + \": \" + edge);\r\n      agenda.push(edge);\r\n    }\r\n  }\r\n  \r\n  // seed the agenda with the starting rule\r\n  addToChart(\"INIT\", 0, 0, root, grammar[root], {}, {}, {});\r\n  \r\n  // main loop\r\n  while (agenda.length > 0) {\r\n    var edge = agenda.pop();\r\n    var start= edge.start;\r\n    var end  = edge.end;\r\n    var lhs  = edge.lhs;\r\n    var next = edge.next;\r\n    LOG(edge);\r\n\r\n    if (edge.isPassive) {\r\n      // combine\r\n      var actives = chart.actives[start][lhs];\r\n      for (var i in actives) {\r\n\tvar active = actives[i];\r\n\tvar rules = clone(active.rules);\r\n\tvar text = active.text;\r\n\ttext[edge.lhs] = words.slice(start, end).join(\" \");\r\n\tif (typeof edge.out == 'object' && isEmpty(edge.out)) {\r\n\t    rules[edge.lhs] = text[edge.lhs];\r\n\t} else {\r\n        rules[edge.lhs] = clone(edge.out);\r\n    }\r\n\taddToChart(\"COMBINE\", active.start, end, active.lhs, active.rest, active.out, rules, text);\r\n      }\r\n\r\n    } else if (next.constructor == SRGS.RefClass) {\r\n      var ref = next.content;\r\n      // combine\r\n      var passives = chart.passives[end][ref];\r\n      for (var i in passives) {\r\n\tvar passive = passives[i];\r\n\tvar rules = clone(edge.rules);\r\n\tvar text = edge.text;\r\n\trules[passive.lhs] = clone(passive.out);\r\n\ttext[passive.lhs] = passive.text;\r\n\taddToChart(\"COMBINE\", start, passive.end, lhs, edge.rest, edge.out, rules, text);\r\n      }\r\n      // predict\r\n      if (ref in grammar) {\r\n\tif (leftCornerFilter(ref, end)) {\r\n\t  addToChart(\"PREDICT\", end, end, ref, grammar[ref], {}, {}, {});\r\n\t}\r\n      }\r\n\r\n    } else if (next == words[end]) {\r\n      // scan\r\n      addToChart(\"SCAN\", start, end+1, lhs, edge.rest, edge.out, edge.rules, edge.text);\r\n    }\r\n  }\r\n\r\n  return chart;\r\n}\r\n\r\n\r\n","// extracted by mini-css-extract-plugin","//\r\n//  runparser.js\r\n//\r\n/*\r\n  The author or authors of this code dedicate any and all \r\n  copyright interest in this code to the public domain.\r\n*/\r\n\r\n\r\n// helper functions for the parser demo\r\n\r\nimport * as SRGS from './srgs'\r\n\r\nfunction getElement(id) {\r\n  return document.getElementById(id);\r\n}\r\n\r\nfunction appendElement(parent, element, text) {\r\n  var elem = document.createElement(element);\r\n  if (text)\r\n    elem.appendChild(document.createTextNode(text));\r\n  parent.appendChild(elem);\r\n  return elem\r\n}\r\n\r\nfunction runParser(input) {\r\n  var resultsDiv = getElement(\"results\");\r\n  resultsDiv.innerHTML = \"\";\r\n  var maybeFilter;\r\n  if (getElement(\"usefilter\") && getElement(\"usefilter\").checked) {\r\n    maybeFilter = filter;\r\n    appendElement(resultsDiv, \"EM\", \"Using left-corner filter\");\r\n  }\r\n  var startTime = new Date();\r\n  var parseChart = parse(input, grammar, grammar.$root, maybeFilter);\r\n  var parseTime = new Date() - startTime;\r\n  var parseResults = parseChart.resultsForRule(grammar.$root);\r\n  \r\n  console.log(parseResults[0]);\r\n  \r\n  if (parseResults) {\r\n    for (var i in parseResults) {\r\n        resultsDiv.innerHTML += display(parseResults[i],\"\");\r\n    }\r\n  } else {\r\n    appendElement(resultsDiv, \"P\", \"No results found!\");\r\n  }\r\n  \r\n/*\r\n  if (parseResults) { \r\n    var resultList = appendElement(resultsDiv, \"OL\");\r\n    for (var i in parseResults) \r\n      appendElement(resultList, \"LI\", JSON.stringify(parseResults[i]));\r\n  } else {\r\n    appendElement(resultsDiv, \"P\", \"No results found!\");\r\n  }\r\n*/\r\n  var statistics = parseChart.statistics()\r\n  appendElement(resultsDiv, \"P\", \"Chart size: \" + statistics.nrEdges + \" edges\" +\r\n\t\t\" (\" + statistics.nrPassiveEdges + \" passive)\");\r\n  appendElement(resultsDiv, \"P\", \"Parse time: \" + parseTime + \" ms\" + \r\n\t\t\" (\" + (parseTime / statistics.nrEdges).toFixed(2) + \" ms/edge)\");\r\n}\r\n\r\nfunction runWordParser() {\r\n  runParser(getElement(\"input\").value.split(/\\s+/));\r\n}\r\n\r\nfunction runCharacterParser() {\r\n  runParser(getElement(\"input\").value.split(\"\"));\r\n}\r\n\r\nexport function loadGrammar(str) {\r\n    var dom = parseXML(str);\r\n    var root = dom.getElementsByTagName(\"grammar\")[0].getAttribute(\"root\");\r\n    var grammar = new SRGS.Grammar(root);\r\n    var xrules = dom.getElementsByTagName(\"rule\");\r\n    for(var r=0; r < xrules.length; r++) {\r\n        var xrule = xrules[r];\r\n        var id = xrule.getAttribute(\"id\");\r\n        grammar[id] = processRuleExpansions(xrule);\r\n    }\r\n    return grammar;\r\n}\r\n\r\nfunction processRuleExpansions(xrule) {\r\n    var xitems = xrule.childNodes;\r\n    var rule = [];\r\n    for(var i=0; i < xitems.length; i++) {\r\n        if (xitems[i].nodeType == 3) {\r\n            var str = xitems[i].textContent.trim();\r\n            if (str != \"\") {\r\n                rule.push(str.split(/ +/));\r\n            }\r\n        } else if (xitems[i].nodeType == 1) {\r\n            if (xitems[i].nodeName == \"token\") {\r\n                rule.push(SRGS.Tag(xitems[i].textContent));\r\n            } else if (xitems[i].nodeName == \"ruleref\") {\r\n                var uri = xitems[i].getAttribute(\"uri\");\r\n                rule.push(SRGS.Ref(uri.slice(1)));\r\n            } else if (xitems[i].nodeName == \"tag\") {\r\n                rule.push(SRGS.Tag(xitems[i].textContent.trim()));\r\n            } else if (xitems[i].nodeName == \"one-of\") {\r\n                rule.push(SRGS.OneOf(processRuleExpansions(xitems[i])));\r\n            } else if (xitems[i].nodeName == \"item\") {\r\n                var repeat = xitems[i].getAttribute(\"repeat\");\r\n                if (!repeat) {\r\n                    rule.push(processRuleExpansions(xitems[i]));\r\n                } else {\r\n                    var r = repeat.split(\"-\");\r\n                    var min = parseInt(r[0]);\r\n                    var max = parseInt(r[1]);\r\n                    max = (max) ? max : Infinity;\r\n                    rule.push(SRGS.Repeat(min, max, processRuleExpansions(xitems[i])));\r\n                }\r\n            } else {\r\n                console.log(xitems[i]);\r\n            }\r\n        }\r\n    }\r\n\treturn rule;\r\n}\r\n\r\nfunction parseXML(text) {\r\n    if (typeof DOMParser != \"undefined\") {\r\n        // Mozilla, Firefox, and related browsers\r\n        return (new DOMParser()).parseFromString(text, \"application/xml\");\r\n    }\r\n    else if (typeof ActiveXObject != \"undefined\") {\r\n        // Internet Explorer.\r\n        var doc = XML.newDocument();  // Create an empty document\r\n        doc.loadXML(text);            // Parse text into it\r\n        return doc;                   // Return it\r\n    }\r\n    else {\r\n        // As a last resort, try loading the document from a data: URL\r\n        // This is supposed to work in Safari. Thanks to Manos Batsis and\r\n        // his Sarissa library (sarissa.sourceforge.net) for this technique.\r\n        var url = \"data:text/xml;charset=utf-8,\" + encodeURIComponent(text);\r\n        var request = new XMLHttpRequest();\r\n        request.open(\"GET\", url, false);\r\n        request.send(null);\r\n        return request.responseXML;\r\n    }\r\n};\r\n","export const grammar = `\r\n<grammar root=\"order\">\r\n   <rule id=\"order\">\r\n      I would like a\r\n      <ruleref uri=\"#drink\"/>\r\n      <tag>out.drink = new Object(); out.drink.liquid=rules.drink.type;\r\n           out.drink.drinksize=rules.drink.drinksize;</tag>\r\n      and\r\n      <ruleref uri=\"#pizza\"/>\r\n      <tag>out.pizza=rules.pizza;</tag>\r\n   </rule>\r\n   <rule id=\"kindofdrink\">\r\n      <one-of>\r\n         <item>coke</item>\r\n         <item>pepsi</item>\r\n         <item>coca cola<tag>out=\"coke\";</tag></item>\r\n      </one-of>\r\n   </rule>\r\n   <rule id=\"foodsize\">\r\n      <tag>out=\"medium\";</tag> <!-- \"medium\" is default if nothing said -->\r\n      <item repeat=\"0-1\">\r\n         <one-of>\r\n            <item>small<tag>out=\"small\";</tag></item>\r\n            <item>medium</item>\r\n            <item>large<tag>out=\"large\";</tag></item>\r\n            <item>regular<tag>out=\"medium\";</tag></item>\r\n         </one-of>\r\n      </item>\r\n   </rule>\r\n   <!-- Construct Array of toppings, return Array -->\r\n   <rule id=\"tops\">\r\n      <tag>out=new Array;</tag>\r\n      <ruleref uri=\"#top\"/>\r\n      <tag>out.push(rules.top);</tag>\r\n      <item repeat=\"1-\">\r\n         and\r\n         <ruleref uri=\"#top\"/>\r\n         <tag>out.push(rules.top);</tag>\r\n      </item>\r\n   </rule>\r\n   <rule id=\"top\">\r\n      <one-of>\r\n         <item>anchovies</item>\r\n         <item>pepperoni</item>\r\n         <item>mushroom<tag>out=\"mushrooms\";</tag></item>\r\n         <item>mushrooms</item>\r\n      </one-of>\r\n   </rule>\r\n   <!-- Two properties (drinksize, type) on left hand side Rule Variable -->\r\n   <rule id=\"drink\">\r\n      <ruleref uri=\"#foodsize\"/>\r\n      <ruleref uri=\"#kindofdrink\"/>\r\n      <tag>out.drinksize=rules.foodsize; out.type=rules.kindofdrink;</tag>\r\n   </rule>\r\n   <!-- Three properties on rules.pizza -->\r\n   <rule id=\"pizza\">\r\n      <ruleref uri=\"#number\"/>\r\n      <ruleref uri=\"#foodsize\"/>\r\n      <tag>out.pizzasize=rules.foodsize; out.number=rules.number;</tag>\r\n      pizzas with\r\n      <ruleref uri=\"#tops\"/>\r\n      <tag>out.topping=rules.tops;</tag>\r\n   </rule>\r\n   <rule id=\"number\">\r\n      <one-of>\r\n         <item>\r\n            <tag>out=1;</tag>\r\n            <one-of>\r\n               <item>a</item>\r\n               <item>one</item>\r\n            </one-of>\r\n         </item>\r\n         <item>two<tag>out=2;</tag></item>\r\n         <item>three<tag>out=3;</tag></item>\r\n      </one-of>\r\n   </rule>\r\n</grammar>\r\n`\r\n","import { MachineConfig, send, Action } from \"xstate\";\r\n\r\n// SRGS parser and example (logs the results to console on page load)\r\nimport { loadGrammar } from './runparser'\r\nimport { parse } from './chartparser'\r\nimport { grammar } from './grammars/pizzaGrammar'\r\n\r\nconst gram = loadGrammar(grammar)\r\nconst input = \"I would like a coca cola and three large pizzas with pepperoni and mushrooms\"\r\nconst prs = parse(input.split(/\\s+/), gram)\r\nconst result = prs.resultsForRule(gram.$root)[0]\r\n\r\nconsole.log(result)\r\n\r\nconst sayColour: Action<SDSContext, SDSEvent> = send((context: SDSContext) => ({\r\n    type: \"SPEAK\", value: `Repainting to ${context.recResult}`\r\n}))\r\n\r\nfunction say(text: string): Action<SDSContext, SDSEvent> {\r\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\r\n}\r\n\r\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\r\n    return ({\r\n        initial: 'prompt',\r\n        states: {\r\n            prompt: {\r\n                entry: say(prompt),\r\n                on: { ENDSPEECH: 'ask' }\r\n            },\r\n            ask: {\r\n                entry: send('LISTEN'),\r\n            },\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\r\n    initial: 'init',\r\n    states: {\r\n        init: {\r\n            on: {\r\n                CLICK: 'welcome'\r\n            }\r\n        },\r\n        welcome: {\r\n            on: {\r\n                RECOGNISED: [\r\n                    { target: 'stop', cond: (context) => context.recResult === 'stop' },\r\n                    { target: 'repaint' }]\r\n            },\r\n            ...promptAndAsk(\"Tell me the colour\")\r\n        },\r\n        stop: {\r\n            entry: say(\"Ok\"),\r\n            always: 'init'\r\n        },\r\n        repaint: {\r\n            initial: 'prompt',\r\n            states: {\r\n                prompt: {\r\n                    entry: sayColour,\r\n                    on: { ENDSPEECH: 'repaint' }\r\n                },\r\n                repaint: {\r\n                    entry: 'changeColour',\r\n                    always: '#root.dm.welcome'\r\n                }\r\n            }\r\n        }\r\n    }\r\n})\r\n","import \"./styles.scss\";\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { Machine, assign, send, State } from \"xstate\";\r\nimport { useMachine, asEffect } from \"@xstate/react\";\r\nimport { inspect } from \"@xstate/inspect\";\r\nimport { dmMachine } from \"./dmColourChanger\";\r\n\r\n\r\ninspect({\r\n    url: \"https://statecharts.io/inspect\",\r\n    iframe: false\r\n});\r\n\r\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\r\n\r\n\r\nconst machine = Machine<SDSContext, any, SDSEvent>({\r\n    id: 'root',\r\n    type: 'parallel',\r\n    states: {\r\n        dm: {\r\n            ...dmMachine\r\n        },\r\n        asrtts: {\r\n            initial: 'idle',\r\n            states: {\r\n                idle: {\r\n                    on: {\r\n                        LISTEN: 'recognising',\r\n                        SPEAK: {\r\n                            target: 'speaking',\r\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\r\n                        }\r\n                    }\r\n                },\r\n                recognising: {\r\n                    initial: 'progress',\r\n                    entry: 'recStart',\r\n                    exit: 'recStop',\r\n                    on: {\r\n                        ASRRESULT: {\r\n                            actions: ['recLogResult',\r\n                                assign((_context, event) => { return { recResult: event.value } })],\r\n                            target: '.match'\r\n                        },\r\n                        RECOGNISED: 'idle'\r\n                    },\r\n                    states: {\r\n                        progress: {\r\n                        },\r\n                        match: {\r\n                            entry: send('RECOGNISED'),\r\n                        },\r\n                    }\r\n                },\r\n                speaking: {\r\n                    entry: 'ttsStart',\r\n                    on: {\r\n                        ENDSPEECH: 'idle',\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n},\r\n    {\r\n        actions: {\r\n            recLogResult: (context: SDSContext) => {\r\n                /* context.recResult = event.recResult; */\r\n                console.log('<< ASR: ' + context.recResult);\r\n            },\r\n            test: () => {\r\n                console.log('test')\r\n            },\r\n            logIntent: (context: SDSContext) => {\r\n                /* context.nluData = event.data */\r\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\r\n            }\r\n        },\r\n    });\r\n\r\n\r\n\r\ninterface Props extends React.HTMLAttributes<HTMLElement> {\r\n    state: State<SDSContext, any, any, any>;\r\n}\r\nconst ReactiveButton = (props: Props): JSX.Element => {\r\n    switch (true) {\r\n        case props.state.matches({ asrtts: 'recognising' }):\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"glowing 20s linear\" }} {...props}>\r\n                    Listening...\r\n                </button>\r\n            );\r\n        case props.state.matches({ asrtts: 'speaking' }):\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\r\n                    Speaking...\r\n                </button>\r\n            );\r\n        default:\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\r\n                    Click to start\r\n                </button >\r\n            );\r\n    }\r\n}\r\n\r\nfunction App() {\r\n    const { speak, cancel, speaking } = useSpeechSynthesis({\r\n        onEnd: () => {\r\n            send('ENDSPEECH');\r\n        },\r\n    });\r\n    const { listen, listening, stop } = useSpeechRecognition({\r\n        onResult: (result: any) => {\r\n            send({ type: \"ASRRESULT\", value: result });\r\n        },\r\n    });\r\n    const [current, send, service] = useMachine(machine, {\r\n        devTools: true,\r\n        actions: {\r\n            recStart: asEffect(() => {\r\n                console.log('Ready to receive a color command.');\r\n                listen({\r\n                    interimResults: false,\r\n                    continuous: true\r\n                });\r\n            }),\r\n            recStop: asEffect(() => {\r\n                console.log('Recognition stopped.');\r\n                stop()\r\n            }),\r\n            changeColour: asEffect((context) => {\r\n                console.log('Repainting...');\r\n                document.body.style.background = context.recResult;\r\n            }),\r\n            ttsStart: asEffect((context, effect) => {\r\n                console.log('Speaking...');\r\n                speak({ text: context.ttsAgenda })\r\n            }),\r\n            ttsCancel: asEffect((context, effect) => {\r\n                console.log('TTS STOP...');\r\n                cancel()\r\n            })\r\n            /* speak: asEffect((context) => {\r\n\t     * console.log('Speaking...');\r\n             *     speak({text: context.ttsAgenda })\r\n             * } */\r\n        }\r\n    });\r\n\r\n\r\n    return (\r\n        <div className=\"App\">\r\n            <ReactiveButton state={current} onClick={() => send('CLICK')} />\r\n        </div>\r\n    )\r\n};\r\n\r\n\r\n\r\n/* RASA API\r\n *  */\r\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\";\r\nconst rasaurl = 'https://rasa-nlu-api-00.herokuapp.com/model/parse'\r\nconst nluRequest = (text: string) =>\r\n    fetch(new Request(proxyurl + rasaurl, {\r\n        method: 'POST',\r\n        headers: { 'Origin': 'http://maraev.me' }, // only required with proxy\r\n        body: `{\"text\": \"${text}\"}`\r\n    }))\r\n        .then(data => data.json());\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(\r\n    <App />,\r\n    rootElement);\r\n","//\r\n//  srgs.js\r\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\r\n//\r\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// encoding SRGS grammars in javascript\r\n\r\nexport function Grammar(root) {\r\n  this.$root = root;\r\n  \r\n  this.VOID = [OneOf([])];\r\n  this.NULL = [];\r\n  this.GARBAGE = []; \r\n  \r\n  this.$check = function() {\r\n    for (var i in this) {\r\n      if (i !== \"$root\" && i !== \"$check\") {\r\n\ttry {\r\n\t  checkSequenceExpansion(this[i]);\r\n\t} catch(err) {\r\n\t  throwRuleError(\"When checking grammar rule '\" + i + \"'\", err);\r\n\t}\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function WordSet(str) {\r\n  var words = str.split(/ +/);\r\n  var set = {};\r\n  for (var i in words) {\r\n    set[words[i]] = true;\r\n  }\r\n  return set;\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// rule expansion constructors\r\n\r\n// sequences are ordinary arrays\r\nexport function Sequence(seq) {\r\n  return seq;\r\n}\r\n\r\nexport function Ref(ref) {\r\n  return new RefClass(ref);\r\n}\r\n\r\nexport function Tag(tag) {\r\n  return new TagClass(tag);\r\n}\r\n\r\nexport function OneOf(alternatives) {\r\n  return new OneOfClass(alternatives);\r\n}\r\n\r\nexport function Repeat(min, max, sequence) {\r\n  return new RepeatClass(min, max, sequence);\r\n}\r\n\r\nexport function Optional(sequence) {\r\n  return new RepeatClass(0, 1, sequence);\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// rule expansion classes\r\n\r\nexport function RefClass(ruleref) {\r\n  this.content = ruleref;\r\n  this._string = \"$\" + ruleref;\r\n  this.toString = function toString() {return this._string}\r\n}\r\n    \r\nexport function TagClass(tag) {\r\n  this.content = tag;\r\n  this._string = \"{\" + tag + \"}\";\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\nexport function OneOfClass(alternatives) {\r\n  this.content = alternatives;\r\n  this._string = \"(\" + alternatives.join(\"|\") + \")\";\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\nexport function RepeatClass(min, max, sequence) {\r\n  this.min = min;\r\n  this.max = max;\r\n  this.content = sequence;\r\n  this._string = this.content + \"<\" + this.min + \"-\" + (this.max==Infinity ? \"\" : this.max) + \">\"\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// checking rule expansions\r\n\r\nexport function throwRuleError(message, error) {\r\n  if (error == undefined) {\r\n    throw TypeError(message);\r\n  } else {\r\n    throw TypeError(message + \"; \" + error.message);\r\n  }\r\n}\r\n\r\nexport function checkSequenceExpansion(sequence) {\r\n  try {\r\n    if (sequence.constructor !== Array) {\r\n      throwRuleError(\"Expected Array, found \" + sequence.constructor.name);\r\n    }\r\n    for (var i in sequence) {\r\n      if (sequence[i].constructor == Array) {\r\n\tcheckSequenceExpansion(sequence[i]);\r\n      } else if (sequence[i].constructor != String) {\r\n\tsequence[i].checkExpansion();\r\n      }\r\n    }\r\n  } catch(err) {\r\n    throwRuleError(\"When checking sequence expansion\", err);\r\n  }\r\n};\r\n\r\nRefClass.prototype.checkExpansion = function checkExpansion() {\r\n  if (this.content.constructor !== String) {\r\n    throwRuleError(\"When checking Ref content; Expected String, found \" + this.content.constructor.name);\r\n  }\r\n};\r\n\r\nTagClass.prototype.checkExpansion = function checkExpansion() {\r\n  if (this.content.constructor !== String) {\r\n      throwRuleError(\"When checking Tag content; Expected String, found \" + this.content.constructor.name);\r\n  }\r\n};\r\n\r\nOneOfClass.prototype.checkExpansion = function checkExpansion() {\r\n  try {\r\n    if (this.content.constructor !== Array) {\r\n      throwRuleError(\"Expected Array, found \" + this.content.constructor.name);\r\n    }\r\n    for (var i in this.content) {\r\n      checkSequenceExpansion(this.content[i]);\r\n    }\r\n  } catch(err) {\r\n    throwRuleError(\"When checking OneOf content\", err);\r\n  }\r\n};\r\n\r\nRepeatClass.prototype.checkExpansion = function checkExpansion() {\r\n  try {\r\n    if (this.min.constructor !== Number || this.max.constructor !== Number) {\r\n      throwRuleError(\"Expected min/max to be Number, found \" + this.min.constructor.name + \"/\" + this.max.constructor.name);\r\n    }\r\n    if (!(0 <= this.min && this.min <= this.max)) {\r\n      throwRuleError(\"Expected 0 <= min <= max, found \" + this.min + \"/\" + this.max);\r\n    }\r\n    checkSequenceExpansion(this.content);\r\n  } catch(err) {\r\n    throwRuleError(\"When checking Repeat content\", err);\r\n  }\r\n};\r\n\r\n"]}}