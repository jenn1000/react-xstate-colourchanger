{"code":"(this[\"webpackJsonpxstate-react-typescript-template\"]=this[\"webpackJsonpxstate-react-typescript-template\"]||[]).push([[0],{14:function(t,e,n){\"use strict\";function s(t,e,n){return new a(t,e,n)}function r(t){this.content=t,this._string=\"$\"+t,this.toString=function(){return this._string}}function i(t){this.content=t,this._string=\"{\"+t+\"}\",this.toString=function(){return this._string}}function o(t){this.content=t,this._string=\"(\"+t.join(\"|\")+\")\",this.toString=function(){return this._string}}function a(t,e,n){this.min=t,this.max=e,this.content=n,this._string=this.content+\"<\"+this.min+\"-\"+(this.max==1/0?\"\":this.max)+\">\",this.toString=function(){return this._string}}function c(t,e){throw void 0==e?TypeError(t):TypeError(t+\"; \"+e.message)}function u(t){try{for(var e in t.constructor!==Array&&c(\"Expected Array, found \"+t.constructor.name),t)t[e].constructor==Array?u(t[e]):t[e].constructor!=String&&t[e].checkExpansion()}catch(n){c(\"When checking sequence expansion\",n)}}n.d(e,\"c\",(function(){return s})),n.d(e,\"b\",(function(){return r})),n.d(e,\"e\",(function(){return i})),n.d(e,\"a\",(function(){return o})),n.d(e,\"d\",(function(){return a})),r.prototype.checkExpansion=function(){this.content.constructor!==String&&c(\"When checking Ref content; Expected String, found \"+this.content.constructor.name)},i.prototype.checkExpansion=function(){this.content.constructor!==String&&c(\"When checking Tag content; Expected String, found \"+this.content.constructor.name)},o.prototype.checkExpansion=function(){try{for(var t in this.content.constructor!==Array&&c(\"Expected Array, found \"+this.content.constructor.name),this.content)u(this.content[t])}catch(e){c(\"When checking OneOf content\",e)}},a.prototype.checkExpansion=function(){try{this.min.constructor===Number&&this.max.constructor===Number||c(\"Expected min/max to be Number, found \"+this.min.constructor.name+\"/\"+this.max.constructor.name),0<=this.min&&this.min<=this.max||c(\"Expected 0 <= min <= max, found \"+this.min+\"/\"+this.max),u(this.content)}catch(t){c(\"When checking Repeat content\",t)}}},22:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.d(__webpack_exports__,\"a\",(function(){return parse}));var _srgs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);function LOG(t){}function clone(t){if(null==t||\"object\"!=typeof t)return t;var e=new t.constructor;for(var n in t)e[n]=clone(t[n]);return e}function isEmpty(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Chart(t){this.numberOfWords=t,this.passives=new Array(t),this.actives=new Array(t);for(var e=0;e<=t;e++)this.passives[e]={},this.actives[e]={};this.add=function(t){var e,n;return t.isPassive?(e=this.passives[t.start],n=t.lhs):(e=this.actives[t.end],n=t.next.content),n in e||(e[n]={}),!(t in e[n])&&(e[n][t]=t,!0)},this.resultsForRule=function(e,n,s){n=n||0,s=s||t;var r=[],i=this.passives[n][e];for(var o in i)i[o].end==s&&r.push(i[o].out);return r},this.allEdges=function(){return this.allPassiveEdges().concat(this.allActiveEdges())},this.allPassiveEdges=function(){var t=[];for(var e in this.passives)for(var n in this.passives[e])for(var s in this.passives[e][n])t.push(this.passives[e][n][s]);return t},this.allActiveEdges=function(){var t=[];for(var e in this.actives)for(var n in this.actives[e])for(var s in this.actives[e][n])t.push(this.actives[e][n][s]);return t},this.statistics=function(){var t=this.allPassiveEdges().length,e=this.allActiveEdges().length;return{nrEdges:t+e,nrPassiveEdges:t,nrActiveEdges:e}}}function PassiveEdge(t,e,n,s){this.start=t,this.end=e,this.lhs=n,this.out=s,this.isPassive=!0;var r=\"[\"+t+\"-\"+e+\"] $\"+n+\" := \"+s;this._string=r,this.toString=function(){return this._string}}function ActiveEdge(t,e,n,s,r,i,o,a){this.start=t,this.end=e,this.lhs=n,this.next=s,this.rest=r,this.out=i,this.rules=o,this.text=a,this.isPassive=!1;var c=\"<\"+t+\"-\"+e+\"> $\"+n+\" -> \"+s+\", \"+r+\" := \"+i+\" <- \"+o;this._string=c,this.toString=function(){return this._string}}function parse(words,grammar,root,filter){root||(root=grammar.$root);var chart=new Chart(words.length),agenda=[],leftCornerFilter;function addToChart(inference,start,end,lhs,rhs,out,rules,text){var edge;if(rhs.length>0){var next=rhs[0],rest=rhs.slice(1);switch(next.constructor){case Array:return void addToChart(inference+\",SEQUENCE\",start,end,lhs,next.concat(rest),out,rules,text);case _srgs__WEBPACK_IMPORTED_MODULE_0__.d:var min=next.min,max=next.max;if(min<=0&&addToChart(inference+\",SKIP\",start,end,lhs,rest,out,rules,text),max>0){var content=next.content,rhs=1==max?[content]:[content,_srgs__WEBPACK_IMPORTED_MODULE_0__.c(min?min-1:min,max-1,content)];addToChart(inference+\",REPEAT\",start,end,lhs,rhs.concat(rest),out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.a:var oneof=next.content;for(var i in oneof){var rhs=oneof[i].concat(rest);addToChart(inference+\",ONEOF\",start,end,lhs,rhs,out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.e:return out=clone(out),rules=clone(rules),eval(next.content),void addToChart(inference+\",TAG\",start,end,lhs,rest,out,rules,text)}edge=new ActiveEdge(start,end,lhs,next,rest,out,rules,text)}else edge=new PassiveEdge(start,end,lhs,out);chart.add(edge)&&(LOG(\"+ \"+inference+\": \"+edge),agenda.push(edge))}for(leftCornerFilter=void 0==filter?function(){return!0}:function(t,e){var n=filter[t];return!n||words[e]in n},addToChart(\"INIT\",0,0,root,grammar[root],{},{},{});agenda.length>0;){var edge=agenda.pop(),start=edge.start,end=edge.end,lhs=edge.lhs,next=edge.next;if(LOG(edge),edge.isPassive){var actives=chart.actives[start][lhs];for(var i in actives){var active=actives[i],rules=clone(active.rules),text=active.text;text[edge.lhs]=words.slice(start,end).join(\" \"),\"object\"==typeof edge.out&&isEmpty(edge.out)?rules[edge.lhs]=text[edge.lhs]:rules[edge.lhs]=clone(edge.out),addToChart(\"COMBINE\",active.start,end,active.lhs,active.rest,active.out,rules,text)}}else if(next.constructor==_srgs__WEBPACK_IMPORTED_MODULE_0__.b){var ref=next.content,passives=chart.passives[end][ref];for(var i in passives){var passive=passives[i],rules=clone(edge.rules),text=edge.text;rules[passive.lhs]=clone(passive.out),text[passive.lhs]=passive.text,addToChart(\"COMBINE\",start,passive.end,lhs,edge.rest,edge.out,rules,text)}ref in grammar&&leftCornerFilter(ref,end)&&addToChart(\"PREDICT\",end,end,ref,grammar[ref],{},{},{})}else next==words[end]&&addToChart(\"SCAN\",start,end+1,lhs,edge.rest,edge.out,edge.rules,edge.text)}return chart}},26:function(t,e,n){},37:function(t,e,n){\"use strict\";n.r(e);var s=n(25),r=n(10),i=(n(26),n(7),n(21)),o=n(43),a=n(4),c=n(42),u=n(41),h=n(22);function l(t){return Object(h.a)(t.split(/\\s+/),gram).resultsForRule(gram.$root)[0]}const d={initial:\"init\",states:{init:{on:{CLICK:\"welcome\"}},welcome:Object(r.a)({on:{RECOGNISED:[{cond:t=>void 0!==l(t.recResult),target:\"returntheobject\",actions:Object(a.b)((t=>({option:l(t.recResult)})))},{target:\".nomatch\"}]}},function(t){return{initial:\"prompt\",states:{prompt:{entry:(e=t,Object(a.k)((t=>({type:\"SPEAK\",value:e})))),on:{ENDSPEECH:\"ask\"}},ask:{entry:Object(a.k)(\"LISTEN\")}}};var e}(\"What would you like to do?\")),returnobject:{initial:\"prompt\",on:{ENDSPEECH:\"init\"},states:{prompt:{entry:Object(a.k)((t=>({type:\"SPEAK\",value:\"OK. the object you have chosen is \".concat(t.option.combine.object,\" and the action you have chosen is \").concat(t.option.combine.action,\".\")})))}}}}};var g=n(20),p=n(12);Object(u.a)({url:\"https://statecharts.io/inspect\",iframe:!1});const v=Object(o.a)({id:\"root\",type:\"parallel\",states:{dm:Object(r.a)({},d),asrtts:{initial:\"idle\",states:{idle:{on:{LISTEN:\"recognising\",SPEAK:{target:\"speaking\",actions:Object(a.b)(((t,e)=>({ttsAgenda:e.value})))}}},recognising:{initial:\"progress\",entry:\"recStart\",exit:\"recStop\",on:{ASRRESULT:{actions:[\"recLogResult\",Object(a.b)(((t,e)=>({recResult:e.value})))],target:\".match\"},RECOGNISED:\"idle\"},states:{progress:{},match:{entry:Object(a.k)(\"RECOGNISED\")}}},speaking:{entry:\"ttsStart\",on:{ENDSPEECH:\"idle\"}}}}}},{actions:{recLogResult:t=>{console.log(\"<< ASR: \"+t.recResult)},test:()=>{console.log(\"test\")},logIntent:t=>{console.log(\"<< NLU intent: \"+t.nluData.intent.name)}}}),f=t=>{switch(!0){case t.state.matches({asrtts:\"recognising\"}):return Object(p.jsx)(\"button\",Object(r.a)(Object(r.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},t),{},{children:\"Listening...\"}));case t.state.matches({asrtts:\"speaking\"}):return Object(p.jsx)(\"button\",Object(r.a)(Object(r.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},t),{},{children:\"Speaking...\"}));default:return Object(p.jsx)(\"button\",Object(r.a)(Object(r.a)({type:\"button\",className:\"glow-on-hover\"},t),{},{children:\"Click to start\"}))}};function m(){const t=Object(g.useSpeechSynthesis)({onEnd:()=>{l(\"ENDSPEECH\")}}),e=t.speak,n=t.cancel,r=(t.speaking,Object(g.useSpeechRecognition)({onResult:t=>{l({type:\"ASRRESULT\",value:t})}})),i=r.listen,o=(r.listening,r.stop),a=Object(c.b)(v,{devTools:!0,actions:{recStart:Object(c.a)((()=>{console.log(\"Ready to receive a color command.\"),i({interimResults:!1,continuous:!0})})),recStop:Object(c.a)((()=>{console.log(\"Recognition stopped.\"),o()})),changeColour:Object(c.a)((t=>{console.log(\"Repainting...\"),document.body.style.background=t.recResult})),ttsStart:Object(c.a)(((t,n)=>{console.log(\"Speaking...\"),e({text:t.ttsAgenda})})),ttsCancel:Object(c.a)(((t,e)=>{console.log(\"TTS STOP...\"),n()}))}}),u=Object(s.a)(a,3),h=u[0],l=u[1];u[2];return Object(p.jsx)(\"div\",{className:\"App\",children:Object(p.jsx)(f,{state:h,onClick:()=>l(\"CLICK\")})})}const _=document.getElementById(\"root\");i.render(Object(p.jsx)(m,{}),_)}},[[37,1,2]]]);","name":"static/js/main.898daa24.chunk.js","map":{"version":3,"sources":["static/js/main.898daa24.chunk.js"],"names":["this","push","14","module","__webpack_exports__","__webpack_require__","Repeat","min","max","sequence","RepeatClass","RefClass","ruleref","content","_string","toString","TagClass","tag","OneOfClass","alternatives","join","Infinity","throwRuleError","message","error","undefined","TypeError","checkSequenceExpansion","i","constructor","Array","name","String","checkExpansion","err","d","prototype","Number","22","parse","_srgs__WEBPACK_IMPORTED_MODULE_0__","LOG","str","clone","obj","temp","key","isEmpty","ob","hasOwnProperty","Chart","numberOfWords","passives","actives","add","edge","subchart","cat","isPassive","start","lhs","end","next","resultsForRule","results","finalEdges","out","allEdges","allPassiveEdges","concat","allActiveEdges","edges","j","k","statistics","length","nrEdges","nrPassiveEdges","nrActiveEdges","PassiveEdge","ActiveEdge","rest","rules","text","words","grammar","root","filter","$root","chart","agenda","leftCornerFilter","addToChart","inference","rhs","slice","oneof","eval","position","leftCorners","pop","active","ref","passive","26","exports","37","r","slicedToArray","objectSpread2","react_dom","Machine","actions","useMachine","browser","chartparser","parsing","Object","split","gram","dmMachine","initial","states","init","on","CLICK","welcome","RECOGNISED","cond","context","recResult","target","option","prompt","entry","_context","type","value","ENDSPEECH","ask","promptAndAsk","returnobject","combine","object","action","dist","jsx_runtime","url","iframe","machine","id","dm","asrtts","idle","LISTEN","SPEAK","event","ttsAgenda","recognising","exit","ASRRESULT","progress","match","speaking","recLogResult","console","log","test","logIntent","nluData","intent","ReactiveButton","props","state","matches","className","style","animation","children","App","_useSpeechSynthesis","onEnd","send","speak","cancel","_useSpeechRecognition","onResult","result","listen","stop","listening","_useMachine","devTools","recStart","interimResults","continuous","recStop","changeColour","document","body","background","ttsStart","effect","ttsCancel","_useMachine2","current","onClick","rootElement","getElementById"],"mappings":"CAACA,KAAK,gDAAkDA,KAAK,iDAAmD,IAAIC,KAAK,CAAC,CAAC,GAAG,CAExHC,GACA,SAAUC,EAAQC,EAAqBC,GAE7C,aAsC6L,SAASC,EAAOC,EAAIC,EAAIC,GAAU,OAAO,IAAIC,EAAYH,EAAIC,EAAIC,GAE9P,SAASE,EAASC,GAASZ,KAAKa,QAAQD,EAAQZ,KAAKc,QAAQ,IAAIF,EAAQZ,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAAW,SAASE,EAASC,GAAKjB,KAAKa,QAAQI,EAAIjB,KAAKc,QAAQ,IAAIG,EAAI,IAAIjB,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAAW,SAASI,EAAWC,GAAcnB,KAAKa,QAAQM,EAAanB,KAAKc,QAAQ,IAAIK,EAAaC,KAAK,KAAK,IAAIpB,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAAW,SAASJ,EAAYH,EAAIC,EAAIC,GAAUT,KAAKO,IAAIA,EAAIP,KAAKQ,IAAIA,EAAIR,KAAKa,QAAQJ,EAAST,KAAKc,QAAQd,KAAKa,QAAQ,IAAIb,KAAKO,IAAI,KAAKP,KAAKQ,KAAKa,EAAAA,EAAS,GAAGrB,KAAKQ,KAAK,IAAIR,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAElnB,SAASQ,EAAeC,EAAQC,GAAO,WAAUC,GAAPD,EAAwBE,UAAUH,GAAqBG,UAAUH,EAAQ,KAAKC,EAAMD,SAAW,SAASI,EAAuBlB,GAAU,IAAyG,IAAI,IAAImB,KAA1GnB,EAASoB,cAAcC,OAAOR,EAAe,yBAAyBb,EAASoB,YAAYE,MAAoBtB,EAAaA,EAASmB,GAAGC,aAAaC,MAAOH,EAAuBlB,EAASmB,IAAanB,EAASmB,GAAGC,aAAaG,QAAQvB,EAASmB,GAAGK,iBAAoB,MAAMC,GAAKZ,EAAe,mCAAmCY,IAnCle7B,EAAoB8B,EAAE/B,EAAqB,KAAK,WAAa,OAAOE,KAEpED,EAAoB8B,EAAE/B,EAAqB,KAAK,WAAa,OAAOO,KACpEN,EAAoB8B,EAAE/B,EAAqB,KAAK,WAAa,OAAOY,KACpEX,EAAoB8B,EAAE/B,EAAqB,KAAK,WAAa,OAAOc,KACpEb,EAAoB8B,EAAE/B,EAAqB,KAAK,WAAa,OAAOM,KA8BsaC,EAASyB,UAAUH,eAAe,WAA6BjC,KAAKa,QAAQgB,cAAcG,QAAQV,EAAe,qDAAqDtB,KAAKa,QAAQgB,YAAYE,OAASf,EAASoB,UAAUH,eAAe,WAA6BjC,KAAKa,QAAQgB,cAAcG,QAAQV,EAAe,qDAAqDtB,KAAKa,QAAQgB,YAAYE,OAASb,EAAWkB,UAAUH,eAAe,WAA0B,IAAiH,IAAI,IAAIL,KAAlH5B,KAAKa,QAAQgB,cAAcC,OAAOR,EAAe,yBAAyBtB,KAAKa,QAAQgB,YAAYE,MAAoB/B,KAAKa,QAASc,EAAuB3B,KAAKa,QAAQe,IAAM,MAAMM,GAAKZ,EAAe,8BAA8BY,KAAQxB,EAAY0B,UAAUH,eAAe,WAA0B,IAAOjC,KAAKO,IAAIsB,cAAcQ,QAAQrC,KAAKQ,IAAIqB,cAAcQ,QAAQf,EAAe,wCAAwCtB,KAAKO,IAAIsB,YAAYE,KAAK,IAAI/B,KAAKQ,IAAIqB,YAAYE,MAAY,GAAG/B,KAAKO,KAAKP,KAAKO,KAAKP,KAAKQ,KAAMc,EAAe,mCAAmCtB,KAAKO,IAAI,IAAIP,KAAKQ,KAAMmB,EAAuB3B,KAAKa,SAAU,MAAMqB,GAAKZ,EAAe,+BAA+BY,MAI5oDI,GACA,SAAUnC,OAAQC,oBAAqBC,qBAE7C,aAC+BA,oBAAoB8B,EAAE/B,oBAAqB,KAAK,WAAa,OAAOmC,SAC9E,IAAIC,mCAAqCnC,oBAAoB,IAyBlF,SAASoC,IAAIC,IAIb,SAASC,MAAMC,GAAK,GAAQ,MAALA,GAAuB,iBAALA,EAAe,OAAOA,EAAK,IAAIC,EAAK,IAAID,EAAIf,YAAc,IAAI,IAAIiB,KAAOF,EAAKC,EAAKC,GAAKH,MAAMC,EAAIE,IAAO,OAAOD,EAAM,SAASE,QAAQC,GAAI,IAAI,IAAIpB,KAAKoB,EAAI,GAAGA,EAAGC,eAAerB,GAAI,OAAO,EAAQ,OAAO,EAGpP,SAASsB,MAAMC,GAAenD,KAAKmD,cAAcA,EAAcnD,KAAKoD,SAAS,IAAItB,MAAMqB,GAAenD,KAAKqD,QAAQ,IAAIvB,MAAMqB,GAAe,IAAI,IAAIvB,EAAE,EAAEA,GAAGuB,EAAcvB,IAAK5B,KAAKoD,SAASxB,GAAG,GAAG5B,KAAKqD,QAAQzB,GAAG,GAGlN5B,KAAKsD,IAAI,SAAaC,GAAM,IAAIC,EAASC,EAA6K,OAAtKF,EAAKG,WAAWF,EAASxD,KAAKoD,SAASG,EAAKI,OAAOF,EAAIF,EAAKK,MAAUJ,EAASxD,KAAKqD,QAAQE,EAAKM,KAAKJ,EAAIF,EAAKO,KAAKjD,SAAc4C,KAAOD,IAAWA,EAASC,GAAK,MAAOF,KAAQC,EAASC,MAAyBD,EAASC,GAAKF,GAAMA,GAAY,IAGnSvD,KAAK+D,eAAe,SAAwBH,EAAID,EAAME,GAAKF,EAAMA,GAAO,EAAEE,EAAIA,GAAKV,EAAc,IAAIa,EAAQ,GAAOC,EAAWjE,KAAKoD,SAASO,GAAOC,GAAK,IAAI,IAAIhC,KAAKqC,EAAeA,EAAWrC,GAAGiC,KAAKA,GAAKG,EAAQ/D,KAAKgE,EAAWrC,GAAGsC,KAAO,OAAOF,GAEtPhE,KAAKmE,SAAS,WAAoB,OAAOnE,KAAKoE,kBAAkBC,OAAOrE,KAAKsE,mBAAoBtE,KAAKoE,gBAAgB,WAA2B,IAAIG,EAAM,GAAG,IAAI,IAAI3C,KAAK5B,KAAKoD,SAAS,IAAI,IAAIoB,KAAKxE,KAAKoD,SAASxB,GAAG,IAAI,IAAI6C,KAAKzE,KAAKoD,SAASxB,GAAG4C,GAAGD,EAAMtE,KAAKD,KAAKoD,SAASxB,GAAG4C,GAAGC,IAAI,OAAOF,GAAQvE,KAAKsE,eAAe,WAA0B,IAAIC,EAAM,GAAG,IAAI,IAAI3C,KAAK5B,KAAKqD,QAAQ,IAAI,IAAImB,KAAKxE,KAAKqD,QAAQzB,GAAG,IAAI,IAAI6C,KAAKzE,KAAKqD,QAAQzB,GAAG4C,GAAGD,EAAMtE,KAAKD,KAAKqD,QAAQzB,GAAG4C,GAAGC,IAAI,OAAOF,GAEpevE,KAAK0E,WAAW,WAAsB,IAAItB,EAASpD,KAAKoE,kBAAkBO,OAAWtB,EAAQrD,KAAKsE,iBAAiBK,OAAO,MAAM,CAACC,QAAQxB,EAASC,EAAQwB,eAAezB,EAAS0B,cAAczB,IAEhM,SAAS0B,YAAYpB,EAAME,EAAID,EAAIM,GAAKlE,KAAK2D,MAAMA,EAAM3D,KAAK6D,IAAIA,EAAI7D,KAAK4D,IAAIA,EAAI5D,KAAKkE,IAAIA,EAAIlE,KAAK0D,WAAU,EAAK,IAAIhB,EAAI,IAAIiB,EAAM,IAAIE,EAAI,MAAMD,EAAI,OAAOM,EAAIlE,KAAKc,QAAQ4B,EAAI1C,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAAW,SAASkE,WAAWrB,EAAME,EAAID,EAAIE,EAAKmB,EAAKf,EAAIgB,EAAMC,GAAMnF,KAAK2D,MAAMA,EAAM3D,KAAK6D,IAAIA,EAAI7D,KAAK4D,IAAIA,EAAI5D,KAAK8D,KAAKA,EAAK9D,KAAKiF,KAAKA,EAAKjF,KAAKkE,IAAIA,EAAIlE,KAAKkF,MAAMA,EAAMlF,KAAKmF,KAAKA,EAAKnF,KAAK0D,WAAU,EAAM,IAAIhB,EAAI,IAAIiB,EAAM,IAAIE,EAAI,MAAMD,EAAI,OAAOE,EAAK,KAAKmB,EAAK,OAAOf,EAAI,OAAOgB,EAAMlF,KAAKc,QAAQ4B,EAAI1C,KAAKe,SAAS,WAAoB,OAAOf,KAAKc,SAUrkB,SAASyB,MAAM6C,MAAMC,QAAQC,KAAKC,QAAYD,OAAMA,KAAKD,QAAQG,OAAO,IAAIC,MAAM,IAAIvC,MAAMkC,MAAMT,QAAYe,OAAO,GAAOC,iBAC5H,SAASC,WAAWC,UAAUlC,MAAME,IAAID,IAAIkC,IAAI5B,IAAIgB,MAAMC,MAAM,IAAI5B,KAAK,GAAGuC,IAAInB,OAAO,EAAE,CAAC,IAAIb,KAAKgC,IAAI,GAAOb,KAAKa,IAAIC,MAAM,GAAG,OAAOjC,KAAKjC,aAAa,KAAKC,MAC7E,YAAjF8D,WAAWC,UAAU,YAAYlC,MAAME,IAAID,IAAIE,KAAKO,OAAOY,MAAMf,IAAIgB,MAAMC,MAAa,KAAK3C,mCAAwD,EACrJ,IAAIjC,IAAIuD,KAAKvD,IAAQC,IAAIsD,KAAKtD,IAE9B,GADGD,KAAK,GAAGqF,WAAWC,UAAU,QAAQlC,MAAME,IAAID,IAAIqB,KAAKf,IAAIgB,MAAMC,MAClE3E,IAAI,EAAE,CAAC,IAAIK,QAAQiD,KAAKjD,QAAYiF,IAAS,GAALtF,IAAO,CAACK,SAAS,CAACA,QAAQ2B,mCAAmD,EAAEjC,IAAIA,IAAI,EAAEA,IAAIC,IAAI,EAAEK,UAAU+E,WAAWC,UAAU,UAAUlC,MAAME,IAAID,IAAIkC,IAAIzB,OAAOY,MAAMf,IAAIgB,MAAMC,MAAO,OAAO,KAAK3C,mCAAuD,EAC1S,IAAIwD,MAAMlC,KAAKjD,QAAQ,IAAI,IAAIe,KAAKoE,MAAM,CAAC,IAAIF,IAAIE,MAAMpE,GAAGyC,OAAOY,MAAMW,WAAWC,UAAU,SAASlC,MAAME,IAAID,IAAIkC,IAAI5B,IAAIgB,MAAMC,MAAO,OAAO,KAAK3C,mCAAqD,EACvF,OAApH0B,IAAIvB,MAAMuB,KAAKgB,MAAMvC,MAAMuC,OAAOe,KAAKnC,KAAKjD,cAAS+E,WAAWC,UAAU,OAAOlC,MAAME,IAAID,IAAIqB,KAAKf,IAAIgB,MAAMC,MAAc5B,KAAK,IAAIyB,WAAWrB,MAAME,IAAID,IAAIE,KAAKmB,KAAKf,IAAIgB,MAAMC,WAAY5B,KAAK,IAAIwB,YAAYpB,MAAME,IAAID,IAAIM,KAC9NuB,MAAMnC,IAAIC,QAAOd,IAAI,KAAKoD,UAAU,KAAKtC,MAAMmC,OAAOzF,KAAKsD,OAE9D,IAVmKoC,sBAAXlE,GAAR8D,OAAoC,WAA4B,OAAO,GAA8B,SAA0B3E,EAAQsF,GAAU,IAAIC,EAAYZ,OAAO3E,GAAS,OAAOuF,GAAYf,MAAMc,KAAYC,GAStWP,WAAW,OAAO,EAAE,EAAEN,KAAKD,QAAQC,MAAM,GAAG,GAAG,IACzCI,OAAOf,OAAO,GAAE,CAAC,IAAIpB,KAAKmC,OAAOU,MAAUzC,MAAMJ,KAAKI,MAAUE,IAAIN,KAAKM,IAAQD,IAAIL,KAAKK,IAAQE,KAAKP,KAAKO,KAAe,GAAVrB,IAAIc,MAASA,KAAKG,UAAU,CACnJ,IAAIL,QAAQoC,MAAMpC,QAAQM,OAAOC,KAAK,IAAI,IAAIhC,KAAKyB,QAAQ,CAAC,IAAIgD,OAAOhD,QAAQzB,GAAOsD,MAAMvC,MAAM0D,OAAOnB,OAAWC,KAAKkB,OAAOlB,KAAKA,KAAK5B,KAAKK,KAAKwB,MAAMW,MAAMpC,MAAME,KAAKzC,KAAK,KAAyB,iBAAVmC,KAAKW,KAAenB,QAAQQ,KAAKW,KAAMgB,MAAM3B,KAAKK,KAAKuB,KAAK5B,KAAKK,KAAWsB,MAAM3B,KAAKK,KAAKjB,MAAMY,KAAKW,KAAM0B,WAAW,UAAUS,OAAO1C,MAAME,IAAIwC,OAAOzC,IAAIyC,OAAOpB,KAAKoB,OAAOnC,IAAIgB,MAAMC,YAAa,GAAGrB,KAAKjC,aAAaW,mCAAqD,EAAE,CAAC,IAAI8D,IAAIxC,KAAKjD,QAC7duC,SAASqC,MAAMrC,SAASS,KAAKyC,KAAK,IAAI,IAAI1E,KAAKwB,SAAS,CAAC,IAAImD,QAAQnD,SAASxB,GAAOsD,MAAMvC,MAAMY,KAAK2B,OAAWC,KAAK5B,KAAK4B,KAAKD,MAAMqB,QAAQ3C,KAAKjB,MAAM4D,QAAQrC,KAAKiB,KAAKoB,QAAQ3C,KAAK2C,QAAQpB,KAAKS,WAAW,UAAUjC,MAAM4C,QAAQ1C,IAAID,IAAIL,KAAK0B,KAAK1B,KAAKW,IAAIgB,MAAMC,MAC1QmB,OAAOjB,SAAYM,iBAAiBW,IAAIzC,MAAM+B,WAAW,UAAU/B,IAAIA,IAAIyC,IAAIjB,QAAQiB,KAAK,GAAG,GAAG,SAAexC,MAAMsB,MAAMvB,MAChI+B,WAAW,OAAOjC,MAAME,IAAI,EAAED,IAAIL,KAAK0B,KAAK1B,KAAKW,IAAIX,KAAK2B,MAAM3B,KAAK4B,MAAQ,OAAOM,QAI9Ee,GACA,SAAUrG,EAAQsG,EAASpG,KAM3BqG,GACA,SAAUvG,EAAQC,EAAqBC,GAE7C,aAEAA,EAAoBsG,EAAEvG,GAGtB,IAAIwG,EAAgBvG,EAAoB,IAGpCwG,EAAgBxG,EAAoB,IASpCyG,GANSzG,EAAoB,IAGrBA,EAAoB,GAGhBA,EAAoB,KAGhC0G,EAAU1G,EAAoB,IAG9B2G,EAAU3G,EAAoB,GAG9B4G,EAAa5G,EAAoB,IAGjC6G,EAAU7G,EAAoB,IAG9B8G,EAAc9G,EAAoB,IAI4I,SAAS+G,EAAQjC,GAAM,OAAOkC,OAAOF,EAA2B,EAAlCE,CAAqClC,EAAKmC,MAAM,OAAOC,MAAMxD,eAAewD,KAAK/B,OAAO,GAAsJ,MAAMgC,EAAU,CAACC,QAAQ,OAAOC,OAAO,CAACC,KAAK,CAACC,GAAG,CAACC,MAAM,YAAYC,QAAQT,OAAOR,EAA+B,EAAtCQ,CAAyC,CAACO,GAAG,CAACG,WAAW,CAAC,CAACC,KAAKC,QAAsCxG,IAA7B2F,EAAQa,EAAQC,WAAuBC,OAAO,kBAAkBnB,QAAQK,OAAOL,EAAwB,EAA/BK,EAAkCY,IAAgB,CAACG,OAAOhB,EAAQa,EAAQC,gBAAgB,CAACC,OAAO,eAAjd,SAAsBE,GAAQ,MAAM,CAACZ,QAAQ,SAASC,OAAO,CAACW,OAAO,CAACC,OAArWnD,EAA+WkD,EAAlWhB,OAAOL,EAAsB,EAA7BK,EAAgCkB,IAAU,CAAEC,KAAK,QAAQC,MAAMtD,OAA2SyC,GAAG,CAACc,UAAU,QAAQC,IAAI,CAACL,MAAxRjB,OAAOL,EAAsB,EAA7BK,CAAgC,aAAvK,IAAalC,EAA+vByD,CAAa,+BAA+BC,aAAa,CAACpB,QAAQ,SAASG,GAAG,CAACc,UAAU,QAAQhB,OAAO,CAACW,OAAO,CAACC,MAAMjB,OAAOL,EAAsB,EAA7BK,EAAgCY,IAAS,CAAEO,KAAK,QAAQC,MAAM,qCAAqCpE,OAAO4D,EAAQG,OAAOU,QAAQC,OAAO,uCAAuC1E,OAAO4D,EAAQG,OAAOU,QAAQE,OAAO,cAEvlC,IAAIC,EAAO5I,EAAoB,IAG3B6I,EAAc7I,EAAoB,IAGtCgH,OAAOH,EAAyB,EAAhCG,CAAmC,CAAC8B,IAAI,iCAAiCC,QAAO,IAAQ,MAAMC,EAAQhC,OAAON,EAAyB,EAAhCM,CAAmC,CAACiC,GAAG,OAAOd,KAAK,WAAWd,OAAO,CAAC6B,GAAGlC,OAAOR,EAA+B,EAAtCQ,CAAyC,GAAGG,GAAWgC,OAAO,CAAC/B,QAAQ,OAAOC,OAAO,CAAC+B,KAAK,CAAC7B,GAAG,CAAC8B,OAAO,cAAcC,MAAM,CAACxB,OAAO,WAAWnB,QAAQK,OAAOL,EAAwB,EAA/BK,EAAkC,CAACkB,EAASqB,KAAe,CAACC,UAAUD,EAAMnB,aAAaqB,YAAY,CAACrC,QAAQ,WAAWa,MAAM,WAAWyB,KAAK,UAAUnC,GAAG,CAACoC,UAAU,CAAChD,QAAQ,CAAC,eAAeK,OAAOL,EAAwB,EAA/BK,EAAkC,CAACkB,EAASqB,KAAe,CAAC1B,UAAU0B,EAAMnB,WAAWN,OAAO,UAAUJ,WAAW,QAAQL,OAAO,CAACuC,SAAS,GAAGC,MAAM,CAAC5B,MAAMjB,OAAOL,EAAsB,EAA7BK,CAAgC,iBAAiB8C,SAAS,CAAC7B,MAAM,WAAWV,GAAG,CAACc,UAAU,aAAa,CAAC1B,QAAQ,CAACoD,aAAanC,IAAoDoC,QAAQC,IAAI,WAAWrC,EAAQC,YAAaqC,KAAK,KAAKF,QAAQC,IAAI,SAAUE,UAAUvC,IAA4CoC,QAAQC,IAAI,kBAAkBrC,EAAQwC,QAAQC,OAAO3I,UAAiB4I,EAAeC,IAAQ,QAAO,GAAM,KAAKA,EAAMC,MAAMC,QAAQ,CAACtB,OAAO,gBAAgB,OAAmBnC,OAAO6B,EAAiB,IAAxB7B,CAA2B,SAASA,OAAOR,EAA+B,EAAtCQ,CAAyCA,OAAOR,EAA+B,EAAtCQ,CAAyC,CAACmB,KAAK,SAASuC,UAAU,gBAAgBC,MAAM,CAACC,UAAU,uBAAuBL,GAAO,GAAG,CAACM,SAAS,kBAAkB,KAAKN,EAAMC,MAAMC,QAAQ,CAACtB,OAAO,aAAa,OAAmBnC,OAAO6B,EAAiB,IAAxB7B,CAA2B,SAASA,OAAOR,EAA+B,EAAtCQ,CAAyCA,OAAOR,EAA+B,EAAtCQ,CAAyC,CAACmB,KAAK,SAASuC,UAAU,gBAAgBC,MAAM,CAACC,UAAU,0BAA0BL,GAAO,GAAG,CAACM,SAAS,iBAAiB,QAAQ,OAAmB7D,OAAO6B,EAAiB,IAAxB7B,CAA2B,SAASA,OAAOR,EAA+B,EAAtCQ,CAAyCA,OAAOR,EAA+B,EAAtCQ,CAAyC,CAACmB,KAAK,SAASuC,UAAU,iBAAiBH,GAAO,GAAG,CAACM,SAAS,sBAAuB,SAASC,IAAM,MAAMC,EAAoB/D,OAAO4B,EAAyB,mBAAhC5B,CAAmC,CAACgE,MAAM,KAAKC,EAAK,gBAAiBC,EAAMH,EAAoBG,MAAMC,EAAOJ,EAAoBI,OAAmDC,GAAnCL,EAAoBjB,SAAqC9C,OAAO4B,EAA2B,qBAAlC5B,CAAqC,CAACqE,SAASC,IAASL,EAAK,CAAC9C,KAAK,YAAYC,MAAMkD,QAAaC,EAAOH,EAAsBG,OAAiDC,GAAhCJ,EAAsBK,UAAeL,EAAsBI,MAAWE,EAAY1E,OAAOJ,EAA+B,EAAtCI,CAAyCgC,EAAQ,CAAC2C,UAAS,EAAKhF,QAAQ,CAACiF,SAAS5E,OAAOJ,EAA6B,EAApCI,EAAuC,KAAKgD,QAAQC,IAAI,qCAAqCsB,EAAO,CAACM,gBAAe,EAAMC,YAAW,OAAUC,QAAQ/E,OAAOJ,EAA6B,EAApCI,EAAuC,KAAKgD,QAAQC,IAAI,wBAAwBuB,OAAUQ,aAAahF,OAAOJ,EAA6B,EAApCI,EAAuCY,IAAUoC,QAAQC,IAAI,iBAAiBgC,SAASC,KAAKvB,MAAMwB,WAAWvE,EAAQC,aAAauE,SAASpF,OAAOJ,EAA6B,EAApCI,EAAuC,CAACY,EAAQyE,KAAUrC,QAAQC,IAAI,eAAeiB,EAAM,CAACpG,KAAK8C,EAAQ4B,eAAe8C,UAAUtF,OAAOJ,EAA6B,EAApCI,EAAuC,CAACY,EAAQyE,KAAUrC,QAAQC,IAAI,eAAekB,UAGr/FoB,EAAavF,OAAOT,EAA+B,EAAtCS,CAAyC0E,EAAY,GAAGc,EAAQD,EAAa,GAAGtB,EAAKsB,EAAa,GAAWA,EAAa,GAAG,OAAmBvF,OAAO6B,EAAiB,IAAxB7B,CAA2B,MAAM,CAAC0D,UAAU,MAAMG,SAAsB7D,OAAO6B,EAAiB,IAAxB7B,CAA2BsD,EAAe,CAACE,MAAMgC,EAAQC,QAAQ,IAAIxB,EAAK,aAChU,MACmEyB,EAAYT,SAASU,eAAe,QAAQlG,EAAkB,OAAeO,OAAO6B,EAAiB,IAAxB7B,CAA2B8D,EAAI,IAAI4B,KAIvL,CAAC,CAAC,GAAG,EAAE"},"input":"(this[\"webpackJsonpxstate-react-typescript-template\"] = this[\"webpackJsonpxstate-react-typescript-template\"] || []).push([[0],{\n\n/***/ 14:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export Grammar */\n/* unused harmony export WordSet */\n/* unused harmony export Sequence */\n/* unused harmony export Ref */\n/* unused harmony export Tag */\n/* unused harmony export OneOf */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Repeat; });\n/* unused harmony export Optional */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return RefClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return TagClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return OneOfClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return RepeatClass; });\n/* unused harmony export throwRuleError */\n/* unused harmony export checkSequenceExpansion */\n//\n//  srgs.js\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\n//\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/ //////////////////////////////////////////////////////////////////////\n// encoding SRGS grammars in javascript\nfunction Grammar(root){this.$root=root;this.VOID=[OneOf([])];this.NULL=[];this.GARBAGE=[];this.$check=function(){for(var i in this){if(i!==\"$root\"&&i!==\"$check\"){try{checkSequenceExpansion(this[i]);}catch(err){throwRuleError(\"When checking grammar rule '\"+i+\"'\",err);}}}};}function WordSet(str){var words=str.split(/ +/);var set={};for(var i in words){set[words[i]]=true;}return set;}//////////////////////////////////////////////////////////////////////\n// rule expansion constructors\n// sequences are ordinary arrays\nfunction Sequence(seq){return seq;}function Ref(ref){return new RefClass(ref);}function Tag(tag){return new TagClass(tag);}function OneOf(alternatives){return new OneOfClass(alternatives);}function Repeat(min,max,sequence){return new RepeatClass(min,max,sequence);}function Optional(sequence){return new RepeatClass(0,1,sequence);}//////////////////////////////////////////////////////////////////////\n// rule expansion classes\nfunction RefClass(ruleref){this.content=ruleref;this._string=\"$\"+ruleref;this.toString=function toString(){return this._string;};}function TagClass(tag){this.content=tag;this._string=\"{\"+tag+\"}\";this.toString=function toString(){return this._string;};}function OneOfClass(alternatives){this.content=alternatives;this._string=\"(\"+alternatives.join(\"|\")+\")\";this.toString=function toString(){return this._string;};}function RepeatClass(min,max,sequence){this.min=min;this.max=max;this.content=sequence;this._string=this.content+\"<\"+this.min+\"-\"+(this.max==Infinity?\"\":this.max)+\">\";this.toString=function toString(){return this._string;};}//////////////////////////////////////////////////////////////////////\n// checking rule expansions\nfunction throwRuleError(message,error){if(error==undefined){throw TypeError(message);}else{throw TypeError(message+\"; \"+error.message);}}function checkSequenceExpansion(sequence){try{if(sequence.constructor!==Array){throwRuleError(\"Expected Array, found \"+sequence.constructor.name);}for(var i in sequence){if(sequence[i].constructor==Array){checkSequenceExpansion(sequence[i]);}else if(sequence[i].constructor!=String){sequence[i].checkExpansion();}}}catch(err){throwRuleError(\"When checking sequence expansion\",err);}};RefClass.prototype.checkExpansion=function checkExpansion(){if(this.content.constructor!==String){throwRuleError(\"When checking Ref content; Expected String, found \"+this.content.constructor.name);}};TagClass.prototype.checkExpansion=function checkExpansion(){if(this.content.constructor!==String){throwRuleError(\"When checking Tag content; Expected String, found \"+this.content.constructor.name);}};OneOfClass.prototype.checkExpansion=function checkExpansion(){try{if(this.content.constructor!==Array){throwRuleError(\"Expected Array, found \"+this.content.constructor.name);}for(var i in this.content){checkSequenceExpansion(this.content[i]);}}catch(err){throwRuleError(\"When checking OneOf content\",err);}};RepeatClass.prototype.checkExpansion=function checkExpansion(){try{if(this.min.constructor!==Number||this.max.constructor!==Number){throwRuleError(\"Expected min/max to be Number, found \"+this.min.constructor.name+\"/\"+this.max.constructor.name);}if(!(0<=this.min&&this.min<=this.max)){throwRuleError(\"Expected 0 <= min <= max, found \"+this.min+\"/\"+this.max);}checkSequenceExpansion(this.content);}catch(err){throwRuleError(\"When checking Repeat content\",err);}};\n\n/***/ }),\n\n/***/ 22:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return parse; });\n/* harmony import */ var _srgs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(14);\n//\n//  chartparser.js\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\n//\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/ /* Mods by Torbjörn\r\n- Removed the toString() method from Object. Why does it still work?\r\n- Added a text variable (similar to rules). See \r\n*/ //////////////////////////////////////////////////////////////////////\n// a logging function\n//  - uncomment if you want to debug the parsing process\nfunction LOG(str){//console.log(\"\" + str);\n}//////////////////////////////////////////////////////////////////////\n// we need to be able to clone objects between different edges\n// borrowed from http://keithdevens.com/weblog/archive/2007/Jun/07/javascript.clone\nfunction clone(obj){if(obj==null||typeof obj!='object'){return obj;}var temp=new obj.constructor();for(var key in obj){temp[key]=clone(obj[key]);}return temp;}function isEmpty(ob){for(var i in ob){if(ob.hasOwnProperty(i)){return false;}}return true;}//////////////////////////////////////////////////////////////////////\n// parse chart\n// conceptually this is a set of edges, but it is optimized\nfunction Chart(numberOfWords){this.numberOfWords=numberOfWords;this.passives=new Array(numberOfWords);this.actives=new Array(numberOfWords);for(var i=0;i<=numberOfWords;i++){this.passives[i]={};this.actives[i]={};}// Chart.add(edge)\n// add the edge to the chart, return true if the chart was changed \n// (i.e. if the chart didn't already contain the edge)\nthis.add=function add(edge){var subchart,cat;if(edge.isPassive){subchart=this.passives[edge.start];cat=edge.lhs;}else{subchart=this.actives[edge.end];cat=edge.next.content;}if(!(cat in subchart)){subchart[cat]={};}if(edge in subchart[cat]){return false;}else{subchart[cat][edge]=edge;return true;}};// Chart.resultsForRule(lhs, start, end)\n// return all parse results for the given lhs, start, and end\n//  - start, end are optional; defaults to 0, numberOfWords\nthis.resultsForRule=function resultsForRule(lhs,start,end){start=start||0;end=end||numberOfWords;var results=[];var finalEdges=this.passives[start][lhs];for(var i in finalEdges){if(finalEdges[i].end==end){results.push(finalEdges[i].out);}}return results;};// Chart.allEdges() / Chart.allPassiveEdges() / Chart.allActiveEdges()\n// return an array of all (passive/active) edges in the chart\nthis.allEdges=function allEdges(){return this.allPassiveEdges().concat(this.allActiveEdges());};this.allPassiveEdges=function allPassiveEdges(){var edges=[];for(var i in this.passives)for(var j in this.passives[i])for(var k in this.passives[i][j])edges.push(this.passives[i][j][k]);return edges;};this.allActiveEdges=function allActiveEdges(){var edges=[];for(var i in this.actives)for(var j in this.actives[i])for(var k in this.actives[i][j])edges.push(this.actives[i][j][k]);return edges;};// Chart.statistics()\n// return the number of edges in the chart\nthis.statistics=function statistics(){var passives=this.allPassiveEdges().length;var actives=this.allActiveEdges().length;return{nrEdges:passives+actives,nrPassiveEdges:passives,nrActiveEdges:actives};};}//////////////////////////////////////////////////////////////////////\n// parse edges: passive and active\nfunction PassiveEdge(start,end,lhs,out){this.start=start;this.end=end;this.lhs=lhs;this.out=out;this.isPassive=true;var str=\"[\"+start+\"-\"+end+\"] $\"+lhs+\" := \"+out;this._string=str;this.toString=function toString(){return this._string;};}function ActiveEdge(start,end,lhs,next,rest,out,rules,text){this.start=start;this.end=end;this.lhs=lhs;this.next=next;this.rest=rest;this.out=out;this.rules=rules;this.text=text;this.isPassive=false;var str=\"<\"+start+\"-\"+end+\"> $\"+lhs+\" -> \"+next+\", \"+rest+\" := \"+out+\" <- \"+rules;this._string=str;this.toString=function toString(){return this._string;};}//////////////////////////////////////////////////////////////////////\n// the main parsing function: a simple top-down chartparser\n//  - 'words' is an array of strings\n//  - 'grammar' is a hash table of left-hand-sides mapping to arrays of right-hand-sides\n//  - 'root' is the starting category (a string)\n//    if unspecified, use the '$root' property of the grammar\n//  - 'filter' is an optional left-corner filter \n//    (a mapping from categories/rule-refs to words)\n//    if specified, it is used when predicting new edges\n// returns the final chart\nfunction parse(words,grammar,root,filter){if(!root){root=grammar.$root;}var chart=new Chart(words.length);var agenda=[];var leftCornerFilter;if(filter==undefined){leftCornerFilter=function leftCornerFilter(){return true;};}else{leftCornerFilter=function leftCornerFilter(ruleref,position){var leftCorners=filter[ruleref];return leftCorners?words[position]in leftCorners:true;};}// add an edge to the chart and the agenda, if it does not already exist\nfunction addToChart(inference,start,end,lhs,rhs,out,rules,text){var edge;if(rhs.length>0){var next=rhs[0];var rest=rhs.slice(1);switch(next.constructor){case Array:// the next symbol is a sequence\naddToChart(inference+\",SEQUENCE\",start,end,lhs,next.concat(rest),out,rules,text);return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* RepeatClass */ \"d\"]:// the next symbol is a repetition\nvar min=next.min;var max=next.max;// skip repeat \nif(min<=0){addToChart(inference+\",SKIP\",start,end,lhs,rest,out,rules,text);}// repeat \nif(max>0){var content=next.content;var rhs=max==1?[content]:[content,_srgs__WEBPACK_IMPORTED_MODULE_0__[/* Repeat */ \"c\"](min?min-1:min,max-1,content)];addToChart(inference+\",REPEAT\",start,end,lhs,rhs.concat(rest),out,rules,text);}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* OneOfClass */ \"a\"]:// the next symbol is a disjunction\nvar oneof=next.content;for(var i in oneof){var rhs=oneof[i].concat(rest);addToChart(inference+\",ONEOF\",start,end,lhs,rhs,out,rules,text);}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__[/* TagClass */ \"e\"]:// the next symbol is a semantic action\nout=clone(out);rules=clone(rules);eval(next.content);addToChart(inference+\",TAG\",start,end,lhs,rest,out,rules,text);return;}edge=new ActiveEdge(start,end,lhs,next,rest,out,rules,text);}else{edge=new PassiveEdge(start,end,lhs,out);}// try to add the edge; if successful, also add it to the agenda\nif(chart.add(edge)){LOG(\"+ \"+inference+\": \"+edge);agenda.push(edge);}}// seed the agenda with the starting rule\naddToChart(\"INIT\",0,0,root,grammar[root],{},{},{});// main loop\nwhile(agenda.length>0){var edge=agenda.pop();var start=edge.start;var end=edge.end;var lhs=edge.lhs;var next=edge.next;LOG(edge);if(edge.isPassive){// combine\nvar actives=chart.actives[start][lhs];for(var i in actives){var active=actives[i];var rules=clone(active.rules);var text=active.text;text[edge.lhs]=words.slice(start,end).join(\" \");if(typeof edge.out=='object'&&isEmpty(edge.out)){rules[edge.lhs]=text[edge.lhs];}else{rules[edge.lhs]=clone(edge.out);}addToChart(\"COMBINE\",active.start,end,active.lhs,active.rest,active.out,rules,text);}}else if(next.constructor==_srgs__WEBPACK_IMPORTED_MODULE_0__[/* RefClass */ \"b\"]){var ref=next.content;// combine\nvar passives=chart.passives[end][ref];for(var i in passives){var passive=passives[i];var rules=clone(edge.rules);var text=edge.text;rules[passive.lhs]=clone(passive.out);text[passive.lhs]=passive.text;addToChart(\"COMBINE\",start,passive.end,lhs,edge.rest,edge.out,rules,text);}// predict\nif(ref in grammar){if(leftCornerFilter(ref,end)){addToChart(\"PREDICT\",end,end,ref,grammar[ref],{},{},{});}}}else if(next==words[end]){// scan\naddToChart(\"SCAN\",start,end+1,lhs,edge.rest,edge.out,edge.rules,edge.text);}}return chart;}\n\n/***/ }),\n\n/***/ 26:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 37:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 5 modules\nvar slicedToArray = __webpack_require__(25);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js + 1 modules\nvar objectSpread2 = __webpack_require__(10);\n\n// EXTERNAL MODULE: ./src/styles.scss\nvar styles = __webpack_require__(26);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(7);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(21);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/Machine.js + 2 modules\nvar Machine = __webpack_require__(43);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/actions.js\nvar actions = __webpack_require__(4);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/react/es/useMachine.js + 3 modules\nvar useMachine = __webpack_require__(42);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/inspect/es/browser.js + 3 modules\nvar browser = __webpack_require__(41);\n\n// EXTERNAL MODULE: ./src/chartparser.js\nvar chartparser = __webpack_require__(22);\n\n// CONCATENATED MODULE: ./src/dmSmartHome.ts\n// SRGS parser and example (logs the results to console on page load)\nfunction say(text){return Object(actions[\"k\" /* send */])(_context=>({type:\"SPEAK\",value:text}));}function dmSmartHome_listen(){return Object(actions[\"k\" /* send */])('LISTEN');}function parsing(text){return Object(chartparser[\"a\" /* parse */])(text.split(/\\s+/),gram).resultsForRule(gram.$root)[0];}function promptAndAsk(prompt){return{initial:'prompt',states:{prompt:{entry:say(prompt),on:{ENDSPEECH:'ask'}},ask:{entry:dmSmartHome_listen()}}};}const dmMachine={initial:'init',states:{init:{on:{CLICK:'welcome'}},welcome:Object(objectSpread2[\"a\" /* default */])({on:{RECOGNISED:[{cond:context=>parsing(context.recResult)!==undefined,target:\"returntheobject\",actions:Object(actions[\"b\" /* assign */])(context=>{return{option:parsing(context.recResult)};})},{target:\".nomatch\"}]}},promptAndAsk(\"What would you like to do?\")),returnobject:{initial:\"prompt\",on:{ENDSPEECH:\"init\"},states:{prompt:{entry:Object(actions[\"k\" /* send */])(context=>({type:\"SPEAK\",value:\"OK. the object you have chosen is \".concat(context.option.combine.object,\" and the action you have chosen is \").concat(context.option.combine.action,\".\")}))}}}}};\n// EXTERNAL MODULE: ./node_modules/react-speech-kit/dist/index.js\nvar dist = __webpack_require__(20);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(12);\n\n// CONCATENATED MODULE: ./src/index.tsx\nObject(browser[\"a\" /* inspect */])({url:\"https://statecharts.io/inspect\",iframe:false});const machine=Object(Machine[\"a\" /* Machine */])({id:'root',type:'parallel',states:{dm:Object(objectSpread2[\"a\" /* default */])({},dmMachine),asrtts:{initial:'idle',states:{idle:{on:{LISTEN:'recognising',SPEAK:{target:'speaking',actions:Object(actions[\"b\" /* assign */])((_context,event)=>{return{ttsAgenda:event.value};})}}},recognising:{initial:'progress',entry:'recStart',exit:'recStop',on:{ASRRESULT:{actions:['recLogResult',Object(actions[\"b\" /* assign */])((_context,event)=>{return{recResult:event.value};})],target:'.match'},RECOGNISED:'idle'},states:{progress:{},match:{entry:Object(actions[\"k\" /* send */])('RECOGNISED')}}},speaking:{entry:'ttsStart',on:{ENDSPEECH:'idle'}}}}}},{actions:{recLogResult:context=>{/* context.recResult = event.recResult; */console.log('<< ASR: '+context.recResult);},test:()=>{console.log('test');},logIntent:context=>{/* context.nluData = event.data */console.log('<< NLU intent: '+context.nluData.intent.name);}}});const ReactiveButton=props=>{switch(true){case props.state.matches({asrtts:'recognising'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},props),{},{children:\"Listening...\"}));case props.state.matches({asrtts:'speaking'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},props),{},{children:\"Speaking...\"}));default:return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\"},props),{},{children:\"Click to start\"}));}};function App(){const _useSpeechSynthesis=Object(dist[\"useSpeechSynthesis\"])({onEnd:()=>{send('ENDSPEECH');}}),speak=_useSpeechSynthesis.speak,cancel=_useSpeechSynthesis.cancel,speaking=_useSpeechSynthesis.speaking;const _useSpeechRecognition=Object(dist[\"useSpeechRecognition\"])({onResult:result=>{send({type:\"ASRRESULT\",value:result});}}),listen=_useSpeechRecognition.listen,listening=_useSpeechRecognition.listening,stop=_useSpeechRecognition.stop;const _useMachine=Object(useMachine[\"b\" /* useMachine */])(machine,{devTools:true,actions:{recStart:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('Ready to receive a color command.');listen({interimResults:false,continuous:true});}),recStop:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('Recognition stopped.');stop();}),changeColour:Object(useMachine[\"a\" /* asEffect */])(context=>{console.log('Repainting...');document.body.style.background=context.recResult;}),ttsStart:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('Speaking...');speak({text:context.ttsAgenda});}),ttsCancel:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('TTS STOP...');cancel();})/* speak: asEffect((context) => {\r\n\t     * console.log('Speaking...');\r\n             *     speak({text: context.ttsAgenda })\r\n             * } */}}),_useMachine2=Object(slicedToArray[\"a\" /* default */])(_useMachine,3),current=_useMachine2[0],send=_useMachine2[1],service=_useMachine2[2];return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"App\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ReactiveButton,{state:current,onClick:()=>send('CLICK')})});};/* RASA API\r\n *  */const proxyurl=\"https://cors-anywhere.herokuapp.com/\";const rasaurl='https://rasa-nlu-api-00.herokuapp.com/model/parse';const nluRequest=text=>fetch(new Request(proxyurl+rasaurl,{method:'POST',headers:{'Origin':'http://maraev.me'},// only required with proxy\nbody:\"{\\\"text\\\": \\\"\".concat(text,\"\\\"}\")})).then(data=>data.json());const rootElement=document.getElementById(\"root\");react_dom[\"render\"](/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App,{}),rootElement);\n\n/***/ })\n\n},[[37,1,2]]]);","inputSourceMap":{"version":3,"sources":["C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/srgs.js","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/chartparser.js","C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-6-0!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-6-1!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\postcss-loader\\src\\index.js??postcss!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\resolve-url-loader\\index.js??ref--5-oneOf-6-3!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\node_modules\\sass-loader\\dist\\cjs.js??ref--5-oneOf-6-4!C:\\Users\\wk789\\Documents\\school\\UU\\dialogue\\lab5\\react-xstate-colourchanger\\src\\styles.scss","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/dmSmartHome.ts","C:/Users/wk789/Documents/school/UU/dialogue/lab5/react-xstate-colourchanger/src/index.tsx"],"names":["Grammar","root","$root","VOID","OneOf","NULL","GARBAGE","$check","i","checkSequenceExpansion","err","throwRuleError","WordSet","str","words","split","set","Sequence","seq","Ref","ref","RefClass","Tag","tag","TagClass","alternatives","OneOfClass","Repeat","min","max","sequence","RepeatClass","Optional","ruleref","content","_string","toString","join","Infinity","message","error","undefined","TypeError","constructor","Array","name","String","checkExpansion","prototype","Number","LOG","clone","obj","temp","key","isEmpty","ob","hasOwnProperty","Chart","numberOfWords","passives","actives","add","edge","subchart","cat","isPassive","start","lhs","end","next","resultsForRule","results","finalEdges","push","out","allEdges","allPassiveEdges","concat","allActiveEdges","edges","j","k","statistics","length","nrEdges","nrPassiveEdges","nrActiveEdges","PassiveEdge","ActiveEdge","rest","rules","text","parse","grammar","filter","chart","agenda","leftCornerFilter","position","leftCorners","addToChart","inference","rhs","slice","SRGS","oneof","eval","pop","active","passive","say","send","_context","type","value","listen","parsing","gram","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","dmMachine","init","CLICK","welcome","RECOGNISED","cond","context","recResult","target","actions","assign","option","returnobject","combine","object","action","inspect","url","iframe","machine","Machine","id","dm","asrtts","idle","LISTEN","SPEAK","event","ttsAgenda","recognising","exit","ASRRESULT","progress","match","speaking","recLogResult","console","log","test","logIntent","nluData","intent","ReactiveButton","props","state","matches","animation","App","useSpeechSynthesis","onEnd","speak","cancel","useSpeechRecognition","onResult","result","listening","stop","useMachine","devTools","recStart","asEffect","interimResults","continuous","recStop","changeColour","document","body","style","background","ttsStart","effect","ttsCancel","current","service","proxyurl","rasaurl","nluRequest","fetch","Request","method","headers","then","data","json","rootElement","getElementById","ReactDOM"],"mappings":"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","file":"x","sourcesContent":["//\r\n//  srgs.js\r\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\r\n//\r\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// encoding SRGS grammars in javascript\r\n\r\nexport function Grammar(root) {\r\n  this.$root = root;\r\n  \r\n  this.VOID = [OneOf([])];\r\n  this.NULL = [];\r\n  this.GARBAGE = []; \r\n  \r\n  this.$check = function() {\r\n    for (var i in this) {\r\n      if (i !== \"$root\" && i !== \"$check\") {\r\n\ttry {\r\n\t  checkSequenceExpansion(this[i]);\r\n\t} catch(err) {\r\n\t  throwRuleError(\"When checking grammar rule '\" + i + \"'\", err);\r\n\t}\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function WordSet(str) {\r\n  var words = str.split(/ +/);\r\n  var set = {};\r\n  for (var i in words) {\r\n    set[words[i]] = true;\r\n  }\r\n  return set;\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// rule expansion constructors\r\n\r\n// sequences are ordinary arrays\r\nexport function Sequence(seq) {\r\n  return seq;\r\n}\r\n\r\nexport function Ref(ref) {\r\n  return new RefClass(ref);\r\n}\r\n\r\nexport function Tag(tag) {\r\n  return new TagClass(tag);\r\n}\r\n\r\nexport function OneOf(alternatives) {\r\n  return new OneOfClass(alternatives);\r\n}\r\n\r\nexport function Repeat(min, max, sequence) {\r\n  return new RepeatClass(min, max, sequence);\r\n}\r\n\r\nexport function Optional(sequence) {\r\n  return new RepeatClass(0, 1, sequence);\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// rule expansion classes\r\n\r\nexport function RefClass(ruleref) {\r\n  this.content = ruleref;\r\n  this._string = \"$\" + ruleref;\r\n  this.toString = function toString() {return this._string}\r\n}\r\n    \r\nexport function TagClass(tag) {\r\n  this.content = tag;\r\n  this._string = \"{\" + tag + \"}\";\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\nexport function OneOfClass(alternatives) {\r\n  this.content = alternatives;\r\n  this._string = \"(\" + alternatives.join(\"|\") + \")\";\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\nexport function RepeatClass(min, max, sequence) {\r\n  this.min = min;\r\n  this.max = max;\r\n  this.content = sequence;\r\n  this._string = this.content + \"<\" + this.min + \"-\" + (this.max==Infinity ? \"\" : this.max) + \">\"\r\n  this.toString = function toString() {return this._string}\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// checking rule expansions\r\n\r\nexport function throwRuleError(message, error) {\r\n  if (error == undefined) {\r\n    throw TypeError(message);\r\n  } else {\r\n    throw TypeError(message + \"; \" + error.message);\r\n  }\r\n}\r\n\r\nexport function checkSequenceExpansion(sequence) {\r\n  try {\r\n    if (sequence.constructor !== Array) {\r\n      throwRuleError(\"Expected Array, found \" + sequence.constructor.name);\r\n    }\r\n    for (var i in sequence) {\r\n      if (sequence[i].constructor == Array) {\r\n\tcheckSequenceExpansion(sequence[i]);\r\n      } else if (sequence[i].constructor != String) {\r\n\tsequence[i].checkExpansion();\r\n      }\r\n    }\r\n  } catch(err) {\r\n    throwRuleError(\"When checking sequence expansion\", err);\r\n  }\r\n};\r\n\r\nRefClass.prototype.checkExpansion = function checkExpansion() {\r\n  if (this.content.constructor !== String) {\r\n    throwRuleError(\"When checking Ref content; Expected String, found \" + this.content.constructor.name);\r\n  }\r\n};\r\n\r\nTagClass.prototype.checkExpansion = function checkExpansion() {\r\n  if (this.content.constructor !== String) {\r\n      throwRuleError(\"When checking Tag content; Expected String, found \" + this.content.constructor.name);\r\n  }\r\n};\r\n\r\nOneOfClass.prototype.checkExpansion = function checkExpansion() {\r\n  try {\r\n    if (this.content.constructor !== Array) {\r\n      throwRuleError(\"Expected Array, found \" + this.content.constructor.name);\r\n    }\r\n    for (var i in this.content) {\r\n      checkSequenceExpansion(this.content[i]);\r\n    }\r\n  } catch(err) {\r\n    throwRuleError(\"When checking OneOf content\", err);\r\n  }\r\n};\r\n\r\nRepeatClass.prototype.checkExpansion = function checkExpansion() {\r\n  try {\r\n    if (this.min.constructor !== Number || this.max.constructor !== Number) {\r\n      throwRuleError(\"Expected min/max to be Number, found \" + this.min.constructor.name + \"/\" + this.max.constructor.name);\r\n    }\r\n    if (!(0 <= this.min && this.min <= this.max)) {\r\n      throwRuleError(\"Expected 0 <= min <= max, found \" + this.min + \"/\" + this.max);\r\n    }\r\n    checkSequenceExpansion(this.content);\r\n  } catch(err) {\r\n    throwRuleError(\"When checking Repeat content\", err);\r\n  }\r\n};\r\n\r\n","//\r\n//  chartparser.js\r\n//  Copyright (C) 2009, Peter Ljunglöf. All rights reserved.\r\n//\r\n/*\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU Lesser General Public License as published \r\n  by the Free Software Foundation, either version 3 of the License, or\r\n  (at your option) any later version.\r\n  \r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n  \r\n  You should have received a copy of the GNU General Public License\r\n  and the GNU Lesser General Public License along with this program.  \r\n  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n/* Mods by Torbjörn\r\n- Removed the toString() method from Object. Why does it still work?\r\n- Added a text variable (similar to rules). See \r\n*/\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// a logging function\r\n//  - uncomment if you want to debug the parsing process\r\nfunction LOG(str) {\r\n  //console.log(\"\" + str);\r\n}\r\n\r\nimport * as SRGS from './srgs'\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// we need to be able to clone objects between different edges\r\n// borrowed from http://keithdevens.com/weblog/archive/2007/Jun/07/javascript.clone\r\nfunction clone(obj){\r\n  if (obj == null || typeof(obj) != 'object') {\r\n    return obj;\r\n  }\r\n  var temp = new obj.constructor(); \r\n  for (var key in obj) {\r\n    temp[key] = clone(obj[key]);\r\n  }\r\n  return temp;\r\n}\r\n\r\n\r\nfunction isEmpty(ob){\r\n   for (var i in ob) { if(ob.hasOwnProperty(i)) {return false;}}\r\n  return true;\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// parse chart\r\n// conceptually this is a set of edges, but it is optimized\r\nfunction Chart(numberOfWords) {\r\n  this.numberOfWords = numberOfWords;\r\n  this.passives = new Array(numberOfWords);\r\n  this.actives = new Array(numberOfWords);\r\n  for (var i = 0; i <= numberOfWords; i++) {\r\n    this.passives[i] = {};\r\n    this.actives[i] = {};\r\n  }\r\n\r\n  // Chart.add(edge)\r\n  // add the edge to the chart, return true if the chart was changed \r\n  // (i.e. if the chart didn't already contain the edge)\r\n  this.add = function add(edge) {\r\n    var subchart, cat;\r\n    if (edge.isPassive) {\r\n      subchart = this.passives[edge.start];\r\n      cat = edge.lhs;\r\n    } else {\r\n      subchart = this.actives[edge.end];\r\n      cat = edge.next.content;\r\n    }\r\n    if (!(cat in subchart)) {\r\n      subchart[cat] = {};\r\n    }\r\n    if (edge in subchart[cat]) {\r\n      return false;\r\n    } else {\r\n      subchart[cat][edge] = edge;\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // Chart.resultsForRule(lhs, start, end)\r\n  // return all parse results for the given lhs, start, and end\r\n  //  - start, end are optional; defaults to 0, numberOfWords\r\n  this.resultsForRule = function resultsForRule(lhs, start, end) {\r\n    start = start || 0;\r\n    end = end || numberOfWords;\r\n    var results = [];\r\n    var finalEdges = this.passives[start][lhs];\r\n    for (var i in finalEdges) {\r\n      if (finalEdges[i].end == end) {\r\n\tresults.push(finalEdges[i].out);\r\n      }\r\n    }\r\n    return results;\r\n  }\r\n  \r\n  // Chart.allEdges() / Chart.allPassiveEdges() / Chart.allActiveEdges()\r\n  // return an array of all (passive/active) edges in the chart\r\n  this.allEdges = function allEdges() {\r\n    return this.allPassiveEdges().concat(this.allActiveEdges());\r\n  }\r\n  this.allPassiveEdges = function allPassiveEdges() {\r\n    var edges = [];\r\n    for (var i in this.passives) \r\n      for (var j in this.passives[i]) \r\n\tfor (var k in this.passives[i][j])\r\n\t  edges.push(this.passives[i][j][k]);\r\n    return edges;\r\n  }\r\n  this.allActiveEdges = function allActiveEdges() {\r\n    var edges = [];\r\n    for (var i in this.actives) \r\n      for (var j in this.actives[i]) \r\n\tfor (var k in this.actives[i][j])\r\n\t  edges.push(this.actives[i][j][k]);\r\n    return edges;\r\n  }\r\n\r\n  // Chart.statistics()\r\n  // return the number of edges in the chart\r\n  this.statistics = function statistics() {\r\n    var passives = this.allPassiveEdges().length;\r\n    var actives = this.allActiveEdges().length;\r\n    return {nrEdges: passives+actives, nrPassiveEdges: passives, nrActiveEdges: actives};\r\n  }\r\n}\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// parse edges: passive and active\r\n\r\nfunction PassiveEdge(start, end, lhs, out) {\r\n  this.start = start;\r\n  this.end = end;\r\n  this.lhs = lhs;\r\n  this.out = out;\r\n  this.isPassive = true;\r\n\r\n  var str = \"[\" + start + \"-\" + end + \"] $\" + lhs + \" := \" + out;\r\n  this._string = str;\r\n  this.toString = function toString() {return this._string;} \r\n}\r\n\r\nfunction ActiveEdge(start, end, lhs, next, rest, out, rules, text) {\r\n  this.start = start;\r\n  this.end = end;\r\n  this.lhs = lhs;\r\n  this.next = next;\r\n  this.rest = rest;\r\n  this.out = out;\r\n  this.rules = rules;\r\n  this.text = text;\r\n  this.isPassive = false;\r\n\r\n  var str = \"<\" + start + \"-\" + end + \"> $\" + lhs + \" -> \" + next + \r\n    \", \" + rest + \" := \" + out + \" <- \" + rules;\r\n  this._string = str;\r\n  this.toString = function toString() {return this._string;} \r\n}\r\n\r\n\r\n//////////////////////////////////////////////////////////////////////\r\n// the main parsing function: a simple top-down chartparser\r\n//  - 'words' is an array of strings\r\n//  - 'grammar' is a hash table of left-hand-sides mapping to arrays of right-hand-sides\r\n//  - 'root' is the starting category (a string)\r\n//    if unspecified, use the '$root' property of the grammar\r\n//  - 'filter' is an optional left-corner filter \r\n//    (a mapping from categories/rule-refs to words)\r\n//    if specified, it is used when predicting new edges\r\n// returns the final chart\r\nexport function parse(words, grammar, root, filter) {\r\n  if (!root) {\r\n    root = grammar.$root;\r\n  }\r\n  var chart = new Chart(words.length);\r\n  var agenda = [];\r\n\r\n  var leftCornerFilter;\r\n  if (filter == undefined) {\r\n    leftCornerFilter = function() {return true};\r\n  } else {\r\n    leftCornerFilter = function leftCornerFilter(ruleref, position) {\r\n      var leftCorners = filter[ruleref];\r\n      return leftCorners ? words[position] in leftCorners : true;\r\n    }\r\n  }\r\n  \r\n  // add an edge to the chart and the agenda, if it does not already exist\r\n  function addToChart(inference, start, end, lhs, rhs, out, rules, text) {\r\n    var edge;\r\n    if (rhs.length > 0) {\r\n      var next = rhs[0];\r\n      var rest = rhs.slice(1);\r\n      switch (next.constructor) {\r\n\t\r\n      case Array:\r\n\t// the next symbol is a sequence\r\n\taddToChart(inference+\",SEQUENCE\", start, end, lhs, next.concat(rest), out, rules, text);\r\n\treturn;\r\n\t\r\n      case SRGS.RepeatClass:\r\n\t// the next symbol is a repetition\r\n\tvar min = next.min;\r\n\tvar max = next.max;\r\n\t// skip repeat \r\n\tif (min <= 0) {\r\n\t  addToChart(inference+\",SKIP\", start, end, lhs, rest, out, rules, text);\r\n\t}\r\n\t// repeat \r\n\tif (max > 0) {\r\n\t  var content = next.content;\r\n\t  var rhs = (max==1 ? [content] : [content, SRGS.Repeat(min ? min-1 : min, max-1, content)]);\r\n\t  addToChart(inference+\",REPEAT\", start, end, lhs, rhs.concat(rest), out, rules, text);\r\n\t}\r\n\treturn;\r\n\t\r\n      case SRGS.OneOfClass:\r\n\t// the next symbol is a disjunction\r\n\tvar oneof = next.content;\r\n\tfor (var i in oneof) {\r\n\t  var rhs = oneof[i].concat(rest);\r\n\t  addToChart(inference+\",ONEOF\", start, end, lhs, rhs, out, rules, text);\r\n\t} \r\n\treturn;\r\n\t\r\n      case SRGS.TagClass:\r\n\t// the next symbol is a semantic action\r\n\tout = clone(out);\r\n\trules = clone(rules);\r\n\teval(next.content);\r\n\taddToChart(inference+\",TAG\", start, end, lhs, rest, out, rules, text);\r\n\treturn;\r\n      }\r\n\r\n      edge = new ActiveEdge(start, end, lhs, next, rest, out, rules, text);\r\n    } else {\r\n      edge = new PassiveEdge(start, end, lhs, out);\r\n    }\r\n    \r\n    // try to add the edge; if successful, also add it to the agenda\r\n    if (chart.add(edge)) {\r\n      LOG(\"+ \" + inference + \": \" + edge);\r\n      agenda.push(edge);\r\n    }\r\n  }\r\n  \r\n  // seed the agenda with the starting rule\r\n  addToChart(\"INIT\", 0, 0, root, grammar[root], {}, {}, {});\r\n  \r\n  // main loop\r\n  while (agenda.length > 0) {\r\n    var edge = agenda.pop();\r\n    var start= edge.start;\r\n    var end  = edge.end;\r\n    var lhs  = edge.lhs;\r\n    var next = edge.next;\r\n    LOG(edge);\r\n\r\n    if (edge.isPassive) {\r\n      // combine\r\n      var actives = chart.actives[start][lhs];\r\n      for (var i in actives) {\r\n\tvar active = actives[i];\r\n\tvar rules = clone(active.rules);\r\n\tvar text = active.text;\r\n\ttext[edge.lhs] = words.slice(start, end).join(\" \");\r\n\tif (typeof edge.out == 'object' && isEmpty(edge.out)) {\r\n\t    rules[edge.lhs] = text[edge.lhs];\r\n\t} else {\r\n        rules[edge.lhs] = clone(edge.out);\r\n    }\r\n\taddToChart(\"COMBINE\", active.start, end, active.lhs, active.rest, active.out, rules, text);\r\n      }\r\n\r\n    } else if (next.constructor == SRGS.RefClass) {\r\n      var ref = next.content;\r\n      // combine\r\n      var passives = chart.passives[end][ref];\r\n      for (var i in passives) {\r\n\tvar passive = passives[i];\r\n\tvar rules = clone(edge.rules);\r\n\tvar text = edge.text;\r\n\trules[passive.lhs] = clone(passive.out);\r\n\ttext[passive.lhs] = passive.text;\r\n\taddToChart(\"COMBINE\", start, passive.end, lhs, edge.rest, edge.out, rules, text);\r\n      }\r\n      // predict\r\n      if (ref in grammar) {\r\n\tif (leftCornerFilter(ref, end)) {\r\n\t  addToChart(\"PREDICT\", end, end, ref, grammar[ref], {}, {}, {});\r\n\t}\r\n      }\r\n\r\n    } else if (next == words[end]) {\r\n      // scan\r\n      addToChart(\"SCAN\", start, end+1, lhs, edge.rest, edge.out, edge.rules, edge.text);\r\n    }\r\n  }\r\n\r\n  return chart;\r\n}\r\n\r\n\r\n","// extracted by mini-css-extract-plugin","import { MachineConfig, send, Action, assign } from \"xstate\";\n\n// SRGS parser and example (logs the results to console on page load)\nimport { loadGrammar } from './runparser'\nimport { parse } from './chartparser'\nimport { grammar } from './grammars/dmHome'\n\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nfunction parsing(text:string): MachineConfig<SDSContext, any, SDSEvent> {\n    return (parse(text.split(/\\s+/), gram).resultsForRule(gram.$root)[0])\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: listen(),\n            },\n        }\n    })\n}\n\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            on: {\n                RECOGNISED: [{\n                    cond: (context) => parsing(context.recResult) !== undefined,\n                    target: \"returntheobject\",\n                    actions: assign((context) => { return { option: parsing(context.recResult) } }),\n                },\n                {target: \".nomatch\" }]    \n            },\n                ...promptAndAsk(\"What would you like to do?\")\n        },\n        returnobject: {\n            initial: \"prompt\",\n            on: { ENDSPEECH: \"init\" },\n            states: {\n                prompt: {\n                    entry: send((context) => ({\n                        type: \"SPEAK\",\n                        value: `OK. the object you have chosen is ${context.option.combine.object} and the action you have chosen is ${context.option.combine.action}.`\n                    }))\n                },\n            }\n        },\n        \n    }\n})\n","import \"./styles.scss\";\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { Machine, assign, send, State } from \"xstate\";\r\nimport { useMachine, asEffect } from \"@xstate/react\";\r\nimport { inspect } from \"@xstate/inspect\";\r\nimport { dmMachine } from \"./dmSmartHome\";\r\n\r\n\r\ninspect({\r\n    url: \"https://statecharts.io/inspect\",\r\n    iframe: false\r\n});\r\n\r\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\r\n\r\n\r\nconst machine = Machine<SDSContext, any, SDSEvent>({\r\n    id: 'root',\r\n    type: 'parallel',\r\n    states: {\r\n        dm: {\r\n            ...dmMachine\r\n        },\r\n        asrtts: {\r\n            initial: 'idle',\r\n            states: {\r\n                idle: {\r\n                    on: {\r\n                        LISTEN: 'recognising',\r\n                        SPEAK: {\r\n                            target: 'speaking',\r\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\r\n                        }\r\n                    }\r\n                },\r\n                recognising: {\r\n                    initial: 'progress',\r\n                    entry: 'recStart',\r\n                    exit: 'recStop',\r\n                    on: {\r\n                        ASRRESULT: {\r\n                            actions: ['recLogResult',\r\n                                assign((_context, event) => { return { recResult: event.value } })],\r\n                            target: '.match'\r\n                        },\r\n                        RECOGNISED: 'idle'\r\n                    },\r\n                    states: {\r\n                        progress: {\r\n                        },\r\n                        match: {\r\n                            entry: send('RECOGNISED'),\r\n                        },\r\n                    }\r\n                },\r\n                speaking: {\r\n                    entry: 'ttsStart',\r\n                    on: {\r\n                        ENDSPEECH: 'idle',\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n},\r\n    {\r\n        actions: {\r\n            recLogResult: (context: SDSContext) => {\r\n                /* context.recResult = event.recResult; */\r\n                console.log('<< ASR: ' + context.recResult);\r\n            },\r\n            test: () => {\r\n                console.log('test')\r\n            },\r\n            logIntent: (context: SDSContext) => {\r\n                /* context.nluData = event.data */\r\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\r\n            }\r\n        },\r\n    });\r\n\r\n\r\n\r\ninterface Props extends React.HTMLAttributes<HTMLElement> {\r\n    state: State<SDSContext, any, any, any>;\r\n}\r\nconst ReactiveButton = (props: Props): JSX.Element => {\r\n    switch (true) {\r\n        case props.state.matches({ asrtts: 'recognising' }):\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"glowing 20s linear\" }} {...props}>\r\n                    Listening...\r\n                </button>\r\n            );\r\n        case props.state.matches({ asrtts: 'speaking' }):\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\r\n                    Speaking...\r\n                </button>\r\n            );\r\n        default:\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\r\n                    Click to start\r\n                </button >\r\n            );\r\n    }\r\n}\r\n\r\nfunction App() {\r\n    const { speak, cancel, speaking } = useSpeechSynthesis({\r\n        onEnd: () => {\r\n            send('ENDSPEECH');\r\n        },\r\n    });\r\n    const { listen, listening, stop } = useSpeechRecognition({\r\n        onResult: (result: any) => {\r\n            send({ type: \"ASRRESULT\", value: result });\r\n        },\r\n    });\r\n    const [current, send, service] = useMachine(machine, {\r\n        devTools: true,\r\n        actions: {\r\n            recStart: asEffect(() => {\r\n                console.log('Ready to receive a color command.');\r\n                listen({\r\n                    interimResults: false,\r\n                    continuous: true\r\n                });\r\n            }),\r\n            recStop: asEffect(() => {\r\n                console.log('Recognition stopped.');\r\n                stop()\r\n            }),\r\n            changeColour: asEffect((context) => {\r\n                console.log('Repainting...');\r\n                document.body.style.background = context.recResult;\r\n            }),\r\n            ttsStart: asEffect((context, effect) => {\r\n                console.log('Speaking...');\r\n                speak({ text: context.ttsAgenda })\r\n            }),\r\n            ttsCancel: asEffect((context, effect) => {\r\n                console.log('TTS STOP...');\r\n                cancel()\r\n            })\r\n            /* speak: asEffect((context) => {\r\n\t     * console.log('Speaking...');\r\n             *     speak({text: context.ttsAgenda })\r\n             * } */\r\n        }\r\n    });\r\n\r\n\r\n    return (\r\n        <div className=\"App\">\r\n            <ReactiveButton state={current} onClick={() => send('CLICK')} />\r\n        </div>\r\n    )\r\n};\r\n\r\n\r\n\r\n/* RASA API\r\n *  */\r\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\";\r\nconst rasaurl = 'https://rasa-nlu-api-00.herokuapp.com/model/parse'\r\nconst nluRequest = (text: string) =>\r\n    fetch(new Request(proxyurl + rasaurl, {\r\n        method: 'POST',\r\n        headers: { 'Origin': 'http://maraev.me' }, // only required with proxy\r\n        body: `{\"text\": \"${text}\"}`\r\n    }))\r\n        .then(data => data.json());\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(\r\n    <App />,\r\n    rootElement);\r\n"]}}